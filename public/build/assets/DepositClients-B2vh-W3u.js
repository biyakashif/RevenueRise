import{r as l,q as g,s as y,a as c,b,d as C,h as D,w as U,e,k as f,i as k,m as E,o as u,t as i,F as x,j as N,x as P,n as T}from"./app-DAygwsjv.js";import{_ as $}from"./AdminLayout-DolgAX2R.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";const S={class:"bg-gradient-to-br from-cyan-400/20 via-blue-500/15 to-indigo-600/20 backdrop-blur-xl p-4 rounded-2xl shadow-2xl border border-cyan-300/30 h-full overflow-y-auto"},B={class:"mb-6"},M={key:0,class:"mb-6 p-4 rounded-xl bg-red-100/80 border border-red-200 text-red-700 text-sm flex items-center gap-2 backdrop-blur-sm"},V={class:"bg-gradient-to-r from-white/40 via-white/30 to-white/20 backdrop-blur-sm rounded-xl shadow-lg overflow-hidden border border-white/30"},j={class:"overflow-x-auto"},L={class:"w-full"},A={class:"p-4 text-sm text-slate-800 font-medium relative"},I={key:0,class:"ml-2 bg-red-500 text-white text-xs rounded-full h-4 w-4 inline-flex items-center justify-center"},z={class:"p-4 text-sm text-slate-700"},W={class:"p-4 text-sm text-slate-700 font-semibold"},q={class:"p-4 text-sm text-slate-700 font-semibold"},H={class:"p-4"},Q=["onClick"],R={__name:"DepositClients",props:{initialUsers:{type:Array,default:()=>[]},initialPage:{type:Number,default:1},initialLastPage:{type:Number,default:1},search:{type:String,default:""}},setup(w){const p=w,m=l([...p.initialUsers]);l(p.initialPage),l(p.initialLastPage);const a=l(p.search),n=l(""),d=l({}),r=async(o="")=>{try{const t=o?`/admin/deposit-clients?search=${encodeURIComponent(o)}`:"/admin/deposit-clients",s=await fetch(t,{headers:{Accept:"application/json"}});if(!s.ok)throw new Error(`HTTP error! Status: ${s.status}`);const h=await s.json();m.value=h.data||[],d.value=h.pending_deposits||{},n.value=""}catch{n.value="Failed to fetch users. Please try again.",setTimeout(()=>n.value="",5e3)}};window.depositUpdated=()=>{r(a.value)},g(()=>{r(a.value),console.log("[DepositClients] Component mounted");const o=()=>{if(!window.Echo){console.log("[DepositClients] Echo not ready, waiting..."),setTimeout(o,100);return}console.log("[DepositClients] Echo ready, setting up listeners"),window.Echo.channel("deposits").listen("DepositCreated",t=>{var s;console.log("[DepositClients] ✅ DepositCreated event received:",t),(s=t==null?void 0:t.deposit)!=null&&s.user_id&&d.value[t.deposit.user_id]!==void 0?d.value[t.deposit.user_id]++:r(a.value)}).listen("DepositStatusUpdated",t=>{console.log("[DepositClients] ✅ DepositStatusUpdated event received:",t),r(a.value)}),console.log("[DepositClients] Deposit channel listeners attached")};o()}),y(()=>{window.depositUpdated&&delete window.depositUpdated,window.Echo&&window.Echo.leaveChannel("deposits")});const v=()=>{r(a.value)},_=o=>{T.visit(`/admin/update-wallet?user_id=${o}`)};return(o,t)=>(u(),c(x,null,[b(C(D),{title:"Deposit Clients"}),b($,null,{default:U(()=>[e("div",S,[t[2]||(t[2]=e("h1",{class:"text-lg font-bold text-slate-800 drop-shadow-sm mb-4"},"Deposit Clients",-1)),e("div",B,[k(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>a.value=s),type:"text",placeholder:"Search by Mobile Number...",class:"w-full max-w-md h-12 rounded-xl bg-white/50 border-0 focus:ring-2 focus:ring-cyan-400 text-slate-900 px-4 placeholder-slate-400 backdrop-blur-sm shadow-lg",onInput:v},null,544),[[E,a.value]])]),n.value?(u(),c("div",M,i(n.value),1)):f("",!0),e("div",V,[e("div",j,[e("table",L,[t[1]||(t[1]=e("thead",null,[e("tr",{class:"bg-white/20 text-slate-700 text-sm font-medium"},[e("th",{class:"p-4 text-left"},"Name"),e("th",{class:"p-4 text-left"},"Mobile Number"),e("th",{class:"p-4 text-left"},"Balance"),e("th",{class:"p-4 text-left"},"Frozen Balance"),e("th",{class:"p-4 text-left"},"Action")])],-1)),e("tbody",null,[(u(!0),c(x,null,N(m.value,s=>(u(),c("tr",{key:s.id,class:"border-t border-white/20 hover:bg-white/10 transition-all duration-200"},[e("td",A,[P(i(s.name)+" ",1),d.value[s.id]>0?(u(),c("span",I,i(d.value[s.id]),1)):f("",!0)]),e("td",z,i(s.mobile_number),1),e("td",W,"$"+i((s.balance??0).toFixed(2)),1),e("td",q,"$"+i((s.frozen_balance??0).toFixed(2)),1),e("td",H,[e("button",{onClick:h=>_(s.id),class:"px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg text-sm font-medium transition-all duration-300 transform hover:scale-[1.02] shadow-lg hover:shadow-xl"}," Update Wallet ",8,Q)])]))),128))])])])])])]),_:1})],64))}},O=F(R,[["__scopeId","data-v-1b0acc58"]]);export{O as default};
