import{u as J,c as S,r as u,q as Y,s as Q,a,b as D,d as M,h as Z,w as P,e as t,k as y,l as ee,t as r,A as W,g as te,i as T,m as E,o as n,y as V,F as U,j as X,n as se}from"./app-CdvAI5iq.js";import{_ as oe}from"./AuthenticatedLayout-DBI621vr.js";const re={class:"bg-gradient-to-br from-cyan-400/20 via-blue-500/15 to-indigo-600/20 backdrop-blur-xl p-4 sm:p-6 rounded-2xl sm:rounded-3xl shadow-2xl border border-cyan-300/30 h-full overflow-y-auto flex items-center justify-center"},ae={class:"w-full"},ne={class:"bg-gradient-to-br from-cyan-400/20 via-blue-500/15 to-indigo-600/20 backdrop-blur-xl p-2 sm:p-4 rounded-2xl sm:rounded-3xl shadow-2xl border border-cyan-300/30 mb-4 sm:mb-6"},le={class:"mb-2 sm:mb-4"},ie={class:"flex justify-between items-center mb-4 sm:mb-6"},ce={class:"flex items-center gap-3"},de={class:"text-lg sm:text-xl font-bold text-slate-800 drop-shadow-sm"},ue={class:"text-xs sm:text-sm text-slate-600 font-medium"},me={class:"bg-gradient-to-r from-white/40 via-white/30 to-white/20 backdrop-blur-sm p-3 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 border border-white/30"},he={class:"flex justify-between w-full items-center"},pe={class:"text-xs text-slate-600 font-medium"},we={class:"text-lg font-bold text-slate-800 flex items-center gap-1"},be={class:"bg-gradient-to-br from-cyan-400/20 via-blue-500/15 to-indigo-600/20 backdrop-blur-xl p-4 sm:p-6 rounded-2xl sm:rounded-3xl shadow-2xl border border-cyan-300/30 mb-4 sm:mb-6 relative"},ye={class:"absolute top-3 right-3"},xe={class:"text-xs text-slate-500 font-medium bg-white/30 px-2 py-1 rounded-full backdrop-blur-sm"},ge={class:"block text-xs font-medium text-slate-700 mb-1 drop-shadow-sm"},ve={class:"flex"},fe={class:"block text-xs font-medium text-slate-700 mb-1 drop-shadow-sm"},_e={class:"relative mb-2"},ke={key:0,class:"flex items-center"},Ce=["src"],Ae={key:1,class:"text-slate-500"},Se={key:0,class:"absolute z-[99999] w-full mt-1 bg-white/95 backdrop-blur-xl rounded-xl shadow-2xl border border-cyan-300/30 max-h-32 overflow-y-auto"},De=["onClick"],Te=["src"],Ee={key:1,class:"w-4 h-4 bg-gradient-to-r from-cyan-400 to-blue-500 rounded-full flex items-center justify-center text-white font-bold text-xs mr-2"},Ue={class:"font-medium text-slate-800 text-sm"},Be={class:"text-xs text-slate-600"},Le={key:0,class:"bg-gradient-to-r from-blue-50/80 to-cyan-50/80 p-2 rounded-lg border border-blue-200/50 mb-2"},Re={class:"flex items-center justify-between"},je={class:"text-xs text-slate-600"},Ne={class:"flex items-center"},Fe=["src"],Ie={class:"font-bold text-slate-800 text-sm"},Oe={class:"block text-xs font-medium text-slate-700 mb-1 drop-shadow-sm"},Me={class:"text-right"},Pe={key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-start justify-center pt-40 z-50 p-4"},We={class:"bg-gradient-to-br from-cyan-400/20 via-blue-500/15 to-indigo-600/20 backdrop-blur-xl rounded-2xl sm:rounded-3xl p-6 w-full max-w-md shadow-2xl border border-white/20"},Ve={class:"text-lg font-semibold mb-4 text-white drop-shadow-sm"},Xe={class:"text-sm text-white/80 mb-2 drop-shadow-sm"},He={key:0,class:"text-xs text-red-600 mb-2 bg-red-50 p-2 rounded-lg border border-red-200"},qe={class:"flex justify-end space-x-2"},$e={class:"bg-gradient-to-br from-cyan-400/20 via-blue-500/15 to-indigo-600/20 backdrop-blur-xl p-4 sm:p-6 rounded-2xl sm:rounded-3xl shadow-2xl border border-cyan-300/30"},Ge={class:"text-lg font-semibold text-slate-800 drop-shadow-sm mb-4"},Ke={key:0,class:"text-slate-500 mt-2 drop-shadow-sm"},ze={key:1,class:"space-y-3"},Je={class:"flex justify-between items-center"},Ye={class:"text-[10px] sm:text-sm"},Qe={class:"flex items-center mb-1"},Ze=["src"],et={key:1,class:"w-4 h-4 bg-gradient-to-r from-cyan-400 to-blue-500 rounded-full flex items-center justify-center text-white font-bold text-[8px] mr-2"},tt={class:"text-slate-800 font-semibold drop-shadow-sm"},st={class:"text-[9px] sm:text-xs text-slate-600 drop-shadow-sm"},ot={class:"text-[9px] sm:text-xs text-slate-500 drop-shadow-sm"},nt={__name:"Withdraw",props:{balances:Object,withdrawals:Array},setup(x){const B=J(),H=S(()=>B.props.translations||{}),p=S(()=>{var s;return(s=B.props.auth)==null?void 0:s.user}),l=s=>H.value[s]||s,w=x,m=u(""),v=u(""),i=u(null),L=u({}),f=u([]),b=u(!1);u(0),u(0),u(0);const R=u(null),q={BTC:"https://assets.coingecko.com/coins/images/1/large/bitcoin.png",ETH:"https://assets.coingecko.com/coins/images/279/large/ethereum.png",USDT:"https://assets.coingecko.com/coins/images/325/large/Tether.png",BNB:"https://assets.coingecko.com/coins/images/825/large/bnb-icon2_2x.png",ADA:"https://assets.coingecko.com/coins/images/975/large/cardano.png",SOL:"https://assets.coingecko.com/coins/images/4128/large/solana.png",DOT:"https://assets.coingecko.com/coins/images/12171/large/polkadot.png",DOGE:"https://assets.coingecko.com/coins/images/5/large/dogecoin.png",AVAX:"https://assets.coingecko.com/coins/images/12559/large/coin-round-red.png",LINK:"https://assets.coingecko.com/coins/images/877/large/chainlink-new-logo.png",USDC:"https://assets.coingecko.com/coins/images/6319/large/USD_Coin_icon.png",XRP:"https://assets.coingecko.com/coins/images/44/large/xrp-symbol-white-128.png",SHIB:"https://assets.coingecko.com/coins/images/11939/large/shiba.png",MATIC:"https://assets.coingecko.com/coins/images/4713/large/matic-token-icon.png",LTC:"https://assets.coingecko.com/coins/images/2/large/litecoin.png"},h=s=>q[s]||null,$=async()=>{try{const s=await fetch("/admin/qr-address-upload");if(s.ok){const o=await s.text(),C=new DOMParser().parseFromString(o,"text/html").querySelector("script[data-page]");if(C){const z=JSON.parse(C.textContent);f.value=z.props.existingCryptos||[];return}}}catch(s){console.error("Failed to fetch available cryptos:",s)}f.value=[{id:1,currency:"BTC",network:"Bitcoin"},{id:2,currency:"ETH",network:"ERC20"},{id:3,currency:"USDT",network:"TRC20"},{id:4,currency:"BNB",network:"BEP20"},{id:5,currency:"SOL",network:"Solana"},{id:6,currency:"USDC",network:"ERC20"},{id:7,currency:"ADA",network:"Cardano"},{id:8,currency:"XRP",network:"Ripple"},{id:9,currency:"DOT",network:"Polkadot"},{id:10,currency:"DOGE",network:"Dogecoin"},{id:11,currency:"AVAX",network:"Avalanche"},{id:12,currency:"SHIB",network:"ERC20"},{id:13,currency:"LINK",network:"ERC20"},{id:14,currency:"MATIC",network:"Polygon"},{id:15,currency:"LTC",network:"Litecoin"}]},j=async()=>{try{const s=["BTC","ETH","USDT","BNB","SOL","USDC","ADA","XRP","DOT","DOGE","AVAX","SHIB","LINK","MATIC","LTC"],o={};for(const e of s)try{const c=await fetch(`https://api.coinbase.com/v2/exchange-rates?currency=${e}`);if(c.ok){const C=await c.json();o[e]=parseFloat(C.data.rates.USD)}}catch(c){console.error(`Failed to fetch ${e} rate:`,c)}o.USDT=o.USDT||1,o.USDC=o.USDC||1,L.value=o}catch(s){console.error("Failed to fetch live rates:",s)}},N=S(()=>{if(!i.value||!m.value)return"0.00";const s=L.value[i.value.currency]||1;return(parseFloat(m.value)/s).toFixed(6)});let F=null;const A=async()=>{try{const s=await fetch("/withdraw",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"});if(!s.ok)return;const o=await s.json();if(o.balances&&(w.balances.usdt_balance=Number(o.balances.usdt_balance).toFixed(2),w.balances.withdraw_limit=Number(o.balances.withdraw_limit).toFixed(2)),Array.isArray(o.withdrawals)){const e=o.withdrawals.map(c=>({...c,amount_withdraw:Number(c.amount_withdraw).toFixed(2)}));w.withdrawals.splice(0,w.withdrawals.length,...e)}}catch(s){console.error("Error fetching status:",s)}};Y(()=>{f.value=[{id:1,currency:"BTC",network:"Bitcoin"},{id:2,currency:"ETH",network:"ERC20"},{id:3,currency:"USDT",network:"TRC20"},{id:4,currency:"BNB",network:"BEP20"},{id:5,currency:"SOL",network:"Solana"},{id:6,currency:"USDC",network:"ERC20"},{id:7,currency:"ADA",network:"Cardano"},{id:8,currency:"XRP",network:"Ripple"},{id:9,currency:"DOT",network:"Polkadot"},{id:10,currency:"DOGE",network:"Dogecoin"},{id:11,currency:"AVAX",network:"Avalanche"},{id:12,currency:"SHIB",network:"ERC20"},{id:13,currency:"LINK",network:"ERC20"},{id:14,currency:"MATIC",network:"Polygon"},{id:15,currency:"LTC",network:"Litecoin"}],A(),$(),j(),F=setInterval(()=>{A(),j()},1e4);try{window.Echo&&p.value&&p.value.id&&window.Echo.private("user."+p.value.id).listen(".balance-updated",s=>{w.balances.usdt_balance=Number(s.balance).toFixed(2)})}catch(s){console.error("Error setting up Echo listener for balance:",s)}document.addEventListener("click",O)}),Q(()=>{clearInterval(F),document.removeEventListener("click",O);try{window.Echo&&p.value&&p.value.id&&window.Echo.leave("user."+p.value.id)}catch(s){console.error("Error cleaning up Echo listener for balance:",s)}});const I=s=>{_.value=!0},g=u(""),_=u(!1),d=u(""),G=async()=>{if(d.value="",!i.value){d.value=l("Please select a cryptocurrency");return}const s=N.value,o={amount_withdraw:m.value,crypto_symbol:i.value.currency,crypto_amount:s,crypto_wallet:v.value,withdraw_password:g.value};se.post("/withdraw",o,{preserveState:!0,preserveScroll:!0,onError:e=>{if(e.amount_withdraw)d.value=Array.isArray(e.amount_withdraw)?e.amount_withdraw[0]:e.amount_withdraw;else if(e.withdraw_password)d.value=Array.isArray(e.withdraw_password)?e.withdraw_password[0]:e.withdraw_password;else if(e.crypto_wallet)d.value=Array.isArray(e.crypto_wallet)?e.crypto_wallet[0]:e.crypto_wallet;else if(e.crypto_symbol)d.value=Array.isArray(e.crypto_symbol)?e.crypto_symbol[0]:e.crypto_symbol;else if(e.crypto_amount)d.value=Array.isArray(e.crypto_amount)?e.crypto_amount[0]:e.crypto_amount;else if(e.error)d.value=Array.isArray(e.error)?e.error[0]:e.error;else if(e.message)d.value=e.message;else{const c=Object.values(e)[0];d.value=Array.isArray(c)?c[0]:c}},onSuccess:e=>{if(e.props.flash&&e.props.flash.error){d.value=e.props.flash.error;return}e.props.flash&&e.props.flash.success&&(_.value=!1,g.value="",m.value="",v.value="",i.value=null,A())}})},K=()=>{var o;const s=((o=w.balances)==null?void 0:o.usdt_balance)??0;m.value=Number(s).toFixed(2)},k=s=>{if(s==null||s==="")return"0.00";const o=Number(s);return isFinite(o)?o.toFixed(2):"0.00"},O=s=>{R.value&&!R.value.contains(s.target)&&(b.value=!1)};return(s,o)=>(n(),a(U,null,[D(M(Z),{title:l("Withdraw")},null,8,["title"]),D(oe,null,{default:P(()=>[t("div",re,[t("div",ae,[t("div",ne,[t("div",le,[t("div",ie,[t("div",ce,[D(M(ee),{href:"/profile",class:"flex items-center justify-center w-10 h-10 bg-gradient-to-br from-slate-500/80 to-gray-600/80 hover:from-slate-600/90 hover:to-gray-700/90 rounded-xl shadow-lg transition-all duration-200 transform hover:scale-105"},{default:P(()=>[...o[5]||(o[5]=[t("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),_:1}),t("div",null,[t("h1",de,r(l("Withdraw")),1),t("p",ue,r(l("Withdraw your funds")),1)])])]),t("div",me,[t("div",he,[t("p",pe,r(l("Available USDT")),1),t("p",we,[W(r(k(x.balances.usdt_balance))+" ",1),o[6]||(o[6]=t("span",{class:"text-xs text-slate-500"},"USDT",-1))])])])])]),t("div",be,[t("div",ye,[t("span",xe," Min Limit "+r(k(x.balances.withdraw_limit)),1)]),t("form",{onSubmit:te(I,["prevent"]),class:"space-y-3"},[t("div",null,[t("label",ge,r(l("USDT Amount")),1),t("div",ve,[T(t("input",{name:"amount_withdraw","onUpdate:modelValue":o[0]||(o[0]=e=>m.value=e),type:"number",step:"any",required:"",class:"flex-1 h-10 rounded-l-xl bg-white/50 border-0 focus:ring-2 focus:ring-cyan-400 text-slate-900 px-3 placeholder-slate-400 backdrop-blur-sm shadow-lg text-sm"},null,512),[[E,m.value]]),t("button",{type:"button",onClick:K,class:"bg-gradient-to-r from-white/60 to-white/40 hover:from-white/70 hover:to-white/50 px-3 rounded-r-xl border-l border-white/30 text-slate-700 font-medium transition-all duration-200 shadow-lg text-sm"},r(l("MAX")),1)])]),t("div",null,[t("label",fe,r(l("Select Cryptocurrency")),1),t("div",_e,[t("div",{onClick:o[1]||(o[1]=e=>b.value=!b.value),class:"w-full h-10 rounded-xl bg-gradient-to-r from-white/60 to-white/40 border-0 focus:ring-2 focus:ring-cyan-400 text-slate-900 px-3 backdrop-blur-sm shadow-lg text-sm cursor-pointer flex items-center justify-between"},[i.value?(n(),a("div",ke,[h(i.value.currency)?(n(),a("img",{key:0,src:h(i.value.currency),alt:"Crypto Logo",class:"w-6 h-6 rounded-full mr-2"},null,8,Ce)):y("",!0),t("span",null,r(i.value.currency)+" - "+r(i.value.network),1)])):(n(),a("span",Ae,r(l("Select cryptocurrency to withdraw")),1)),(n(),a("svg",{class:V(["w-5 h-5 text-slate-500 transition-transform",{"rotate-180":b.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...o[7]||(o[7]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),b.value?(n(),a("div",Se,[(n(!0),a(U,null,X(f.value,e=>(n(),a("div",{key:e.id,onClick:c=>{i.value=e,b.value=!1},class:"flex items-center py-0.5 px-2 hover:bg-gradient-to-r hover:from-white/30 hover:to-white/20 cursor-pointer transition-all"},[h(e.currency)?(n(),a("img",{key:0,src:h(e.currency),alt:"Crypto Logo",class:"w-4 h-4 rounded-full mr-2"},null,8,Te)):(n(),a("div",Ee,r(e.currency.substring(0,1)),1)),t("div",null,[t("div",Ue,r(e.currency),1),t("div",Be,r(e.network),1)])],8,De))),128))])):y("",!0)]),i.value&&m.value?(n(),a("div",Le,[t("div",Re,[t("span",je,r(l("You will receive"))+":",1),t("div",Ne,[h(i.value.currency)?(n(),a("img",{key:0,src:h(i.value.currency),alt:"Crypto Logo",class:"w-4 h-4 mr-1"},null,8,Fe)):y("",!0),t("span",Ie,r(N.value)+" "+r(i.value.currency),1)])])])):y("",!0)]),t("div",null,[t("label",Oe,r(l("Recipient"))+" "+r(i.value?i.value.currency:"USDT")+" "+r(l("Wallet Address")),1),T(t("input",{name:"crypto_wallet","onUpdate:modelValue":o[2]||(o[2]=e=>v.value=e),type:"text",required:"",class:"w-full h-10 rounded-xl bg-white/50 border-0 focus:ring-2 focus:ring-cyan-400 text-slate-900 px-3 placeholder-slate-400 backdrop-blur-sm shadow-lg text-sm"},null,512),[[E,v.value]])]),t("div",Me,[t("button",{onClick:I,class:"px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg text-sm font-medium transition-all duration-300 transform hover:scale-[1.02] shadow-lg hover:shadow-xl"},r(l("Withdraw")),1)])],32)]),_.value?(n(),a("div",Pe,[t("div",We,[t("h3",Ve,r(l("Confirm Withdraw")),1),t("p",Xe,r(l("Enter withdraw password")),1),T(t("input",{"onUpdate:modelValue":o[3]||(o[3]=e=>g.value=e),type:"password",class:"w-full h-8 sm:h-12 rounded-xl bg-white/50 border-0 focus:ring-2 focus:ring-cyan-400 text-slate-900 px-4 placeholder-slate-400 backdrop-blur-sm shadow-lg mb-2",autocomplete:"off"},null,512),[[E,g.value]]),d.value?(n(),a("div",He,r(d.value),1)):y("",!0),t("div",qe,[t("button",{onClick:o[4]||(o[4]=e=>{_.value=!1,g.value="",d.value=""}),class:"px-4 py-2 bg-white/50 hover:bg-white/70 rounded-xl text-sm border border-white/40 transition-all duration-200 text-slate-700"},r(l("Cancel")),1),t("button",{onClick:G,class:"px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl text-sm transition-all duration-200 shadow-lg"},r(l("Confirm Withdraw")),1)])])])):y("",!0),t("div",$e,[t("h2",Ge,r(l("Withdrawal History")),1),x.withdrawals.length===0?(n(),a("div",Ke,r(l("No withdrawals yet"))+".",1)):(n(),a("div",ze,[(n(!0),a(U,null,X(x.withdrawals,e=>(n(),a("div",{key:e.id,class:"bg-gradient-to-r from-white/40 via-white/30 to-white/20 backdrop-blur-sm rounded-xl p-2 sm:p-4 border border-white/30 shadow-lg"},[t("div",Je,[t("div",Ye,[t("div",Qe,[h(e.crypto_symbol||"USDT")?(n(),a("img",{key:0,src:h(e.crypto_symbol||"USDT"),alt:"Crypto Logo",class:"w-4 h-4 mr-2"},null,8,Ze)):(n(),a("div",et,r((e.crypto_symbol||"USDT").substring(0,2)),1)),t("span",tt,[t("strong",null,r(e.crypto_amount?e.crypto_symbol==="USDT"?k(e.crypto_amount):Number(e.crypto_amount).toFixed(6):k(e.amount_withdraw)),1),W(" "+r(e.crypto_symbol||"USDT"),1)])]),t("div",st,"To: "+r(e.crypto_wallet),1),t("div",ot,r(new Date(e.created_at).toLocaleString()),1)]),t("div",null,[t("span",{class:V({"px-2 py-0.5 sm:px-3 sm:py-1 rounded-full text-[9px] sm:text-xs font-medium shadow-sm":!0,"bg-yellow-100/80 text-yellow-800 border border-yellow-200":e.status==="under review","bg-green-100/80 text-green-800 border border-green-200":e.status==="approved","bg-red-100/80 text-red-800 border border-red-200":e.status==="rejected"})},r(e.status.split(" ").map(c=>c.charAt(0).toUpperCase()+c.slice(1)).join(" ")),3)])])]))),128))]))])])])]),_:1})],64))}};export{nt as default};
