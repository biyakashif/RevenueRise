import{u as W,r as x,G as N,c as P,A as q,p as g,s as G,g as H,q as J,w as T,e,a as n,m as i,b as K,x as u,t as l,T as Q,o as d,z as X,j as p,d as j,n as b,F as Y,k as Z,i as ee,y as te}from"./app-C5R0GNTt.js";import{_ as se}from"./AdminLayout-3-NIxIvz.js";import{l as le}from"./lodash-BIzRj_i5.js";const oe={class:"bg-gradient-to-br from-cyan-400/20 via-blue-500/15 to-indigo-600/20 backdrop-blur-xl p-4 rounded-2xl shadow-2xl border border-cyan-300/30 h-full overflow-y-auto"},re={class:"bg-white/20 backdrop-blur-sm px-4 py-3 rounded-lg mb-4 border border-white/30"},ae={class:"flex items-center justify-between flex-wrap gap-3 text-xs text-slate-700"},de={class:"bg-white/30 px-2 py-1 rounded"},ne={class:"bg-white/30 px-2 py-1 rounded"},ie={class:"bg-white/30 px-2 py-1 rounded"},ue={class:"bg-white/30 px-2 py-1 rounded"},pe={class:"bg-white/30 px-2 py-1 rounded"},be={class:"bg-white/30 px-2 py-1 rounded"},ce={class:"bg-white/30 px-2 py-1 rounded"},me={class:"bg-green-100/50 px-2 py-1 rounded text-green-700 font-semibold"},xe={class:"bg-blue-100/50 px-2 py-1 rounded text-blue-700 font-semibold"},we={class:"mb-4 flex gap-3"},fe={class:"bg-gradient-to-r from-white/40 via-white/30 to-white/20 backdrop-blur-sm rounded-xl shadow-lg overflow-hidden border border-white/30"},he={class:"overflow-x-auto"},ve={class:"w-full"},ge={class:"divide-y divide-white/10"},ye={class:"px-2 py-2 text-xs font-medium text-slate-800"},ke={key:0,class:"ml-1 px-1.5 py-0.5 bg-red-500 text-white text-[10px] font-bold rounded"},_e={class:"px-2 py-2 text-xs text-slate-700"},Ve={class:"px-2 py-2 text-xs text-slate-700"},Ue={class:"px-2 py-2 text-xs text-slate-700"},Pe={class:"px-2 py-2 text-xs text-slate-700"},Ie={class:"px-2 py-2 text-xs text-slate-700"},Ce={class:"px-2 py-2 text-xs text-slate-700"},Ee={class:"px-2 py-2 text-xs text-slate-700"},Me={class:"px-2 py-2 text-xs text-slate-700"},Ne={class:"px-2 py-2 text-xs text-slate-700"},Te={class:"px-2 py-2 text-xs"},je=["onClick"],Be=["onClick"],Se={key:0,class:"text-center text-slate-600 text-sm mt-4"},De={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Ae={class:"bg-gradient-to-br from-cyan-400/20 via-blue-500/15 to-indigo-600/20 backdrop-blur-xl p-6 rounded-lg shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto border border-white/20"},ze={class:"text-lg font-bold mb-4 text-slate-800"},Oe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Re={key:0,class:"text-xs text-red-600 mt-1"},$e={key:0,class:"text-xs text-red-600 mt-1"},Fe={key:0,class:"text-xs text-red-600 mt-1"},Le={key:0,class:"text-xs text-red-600 mt-1"},We={key:0,class:"text-xs text-red-600 mt-1"},qe={key:0,class:"text-xs text-red-600 mt-1"},Ge={key:0,class:"text-xs text-red-600 mt-1"},He={key:0,class:"text-xs text-red-600 mt-1"},Je={key:0,class:"text-xs text-red-600 mt-1"},Ke={key:0,class:"text-xs text-red-600 mt-1"},Qe={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Xe={class:"bg-gradient-to-br from-cyan-400/20 via-blue-500/15 to-indigo-600/20 backdrop-blur-xl p-6 rounded-lg shadow-xl w-full max-w-md border border-white/20"},Ye={class:"mt-2 text-sm text-slate-700"},Ze={class:"font-medium text-slate-800"},et={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},tt={class:"bg-gradient-to-br from-cyan-400/20 via-blue-500/15 to-indigo-600/20 backdrop-blur-xl p-6 rounded-lg shadow-xl w-full max-w-md border border-white/20"},rt={__name:"Users",props:{users:Array,search:String,dailyNewUsers:Number},setup(B){const c=W(),f=B,y=x(f.search),k=x(!1),_=x(!1),V=x(!1),v=x(null),U=x(5),r=N({id:null,name:"",mobile_number:"",password:"",withdraw_password:"",invitation_code:"",balance:0,role:"user",referred_by:"",vip_level:"",referral_percentage:5}),a=N({}),m=x(""),h=x(""),S=P(()=>({"bg-green-100 border-green-500 text-green-700":h.value==="success","bg-red-100 border-red-500 text-red-700":h.value==="error"})),w=P(()=>{const o={VIP1:0,VIP2:0,VIP3:0,VIP4:0,VIP5:0,VIP6:0,VIP7:0};return f.users.forEach(t=>{const s=t.vip_level;o.hasOwnProperty(s)&&o[s]++}),o}),D=P(()=>f.users.length);q(()=>c.props.flash,o=>{o.success?(m.value=o.success,h.value="success"):o.error?(m.value=o.error,h.value="error"):(m.value="",h.value=""),m.value&&setTimeout(()=>{m.value="",c.props.flash.success&&(c.props.flash.success=null),c.props.flash.error&&(c.props.flash.error=null)},2e3)},{deep:!0});const I=le.debounce(()=>{g.get(route("admin.users"),{search:y.value},{preserveState:!0,replace:!0})},300),A=o=>{Object.assign(r,o),r.password="",r.withdraw_password="",Object.keys(a).forEach(t=>delete a[t]),k.value=!0},C=()=>{k.value=!1},z=()=>{Object.keys(a).forEach(o=>delete a[o]),g.patch(route("admin.users.update",r.id),{...r,_token:c.props.csrf_token},{preserveScroll:!0,onSuccess:()=>C(),onError:o=>{var t;if(o&&((t=o.message)!=null&&t.includes("419")||o.status===419)){window.location.reload();return}Object.assign(a,o)}})},O=o=>{v.value=o,_.value=!0},E=()=>{v.value=null,_.value=!1},R=()=>{v.value&&g.delete(route("admin.users.destroy",v.value.id),{data:{_token:c.props.csrf_token},preserveScroll:!0,onSuccess:()=>E(),onError:o=>{var t;o&&((t=o.message)!=null&&t.includes("419")||o.status===419)&&window.location.reload()}})},$=()=>{V.value=!0},M=()=>{V.value=!1},F=()=>{g.post(route("admin.users.bulk-update-percentage"),{percentage:U.value,_token:c.props.csrf_token},{preserveScroll:!0,onSuccess:()=>{M(),m.value="Task percentage updated for all users!",h.value="success"},onError:o=>{var t;o&&((t=o.message)!=null&&t.includes("419")||o.status===419)&&window.location.reload()}})};return G(()=>{window.Echo&&window.Echo.channel("users").listen("UserRegistered",o=>{console.log("New user registered:",o.user),g.reload({only:["users","dailyNewUsers"]})})}),H(()=>{window.Echo&&window.Echo.leaveChannel("users")}),(o,t)=>(d(),J(se,null,{default:T(()=>[e("div",oe,[t[24]||(t[24]=e("h2",{class:"text-lg font-bold text-slate-800 drop-shadow-sm mb-4"},"User Management",-1)),e("div",re,[e("div",ae,[t[22]||(t[22]=e("span",{class:"font-semibold text-slate-800"},"Users:",-1)),e("span",de,[t[13]||(t[13]=u("VIP1: ",-1)),e("strong",null,l(w.value.VIP1),1)]),e("span",ne,[t[14]||(t[14]=u("VIP2: ",-1)),e("strong",null,l(w.value.VIP2),1)]),e("span",ie,[t[15]||(t[15]=u("VIP3: ",-1)),e("strong",null,l(w.value.VIP3),1)]),e("span",ue,[t[16]||(t[16]=u("VIP4: ",-1)),e("strong",null,l(w.value.VIP4),1)]),e("span",pe,[t[17]||(t[17]=u("VIP5: ",-1)),e("strong",null,l(w.value.VIP5),1)]),e("span",be,[t[18]||(t[18]=u("VIP6: ",-1)),e("strong",null,l(w.value.VIP6),1)]),e("span",ce,[t[19]||(t[19]=u("VIP7: ",-1)),e("strong",null,l(w.value.VIP7),1)]),e("span",me,[t[20]||(t[20]=u("Today: ",-1)),e("strong",null,l(f.dailyNewUsers),1)]),e("span",xe,[t[21]||(t[21]=u("Total: ",-1)),e("strong",null,l(D.value),1)])])]),K(Q,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"opacity-0 transform -translate-y-4","enter-to-class":"opacity-100 transform translate-y-0","leave-active-class":"transition ease-in duration-200","leave-from-class":"opacity-100 transform translate-y-0","leave-to-class":"opacity-0 transform -translate-y-4"},{default:T(()=>[m.value?(d(),n("div",{key:0,class:X([S.value,"border-l-4 p-4 mb-4"]),role:"alert"},[e("p",null,l(m.value),1)],2)):i("",!0)]),_:1}),e("div",we,[p(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>y.value=s),onInput:t[1]||(t[1]=(...s)=>j(I)&&j(I)(...s)),type:"text",placeholder:"Search by name, mobile, invitation code, or VIP level...",class:"flex-1 h-12 rounded-xl bg-white/50 border-0 focus:ring-2 focus:ring-cyan-400 text-slate-900 px-4 placeholder-slate-400 backdrop-blur-sm shadow-lg"},null,544),[[b,y.value]]),e("button",{onClick:$,class:"px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl text-sm font-medium hover:from-blue-600 hover:to-blue-700 transform hover:scale-105 transition-all duration-200 shadow-lg whitespace-nowrap"}," Update Task % ")]),e("div",fe,[e("div",he,[e("table",ve,[t[23]||(t[23]=e("thead",null,[e("tr",{class:"bg-white/20 text-slate-700 text-xs font-medium"},[e("th",{class:"px-2 py-2 text-left"},"Name"),e("th",{class:"px-2 py-2 text-left"},"Mobile"),e("th",{class:"px-2 py-2 text-left"},"VIP"),e("th",{class:"px-2 py-2 text-left"},"Balance"),e("th",{class:"px-2 py-2 text-left"},"Pass"),e("th",{class:"px-2 py-2 text-left"},"W.Pass"),e("th",{class:"px-2 py-2 text-left"},"Inv.Code"),e("th",{class:"px-2 py-2 text-left"},"Ref.By"),e("th",{class:"px-2 py-2 text-left"},"Tasks %"),e("th",{class:"px-2 py-2 text-left"},"Date"),e("th",{class:"px-2 py-2 text-left"},"Actions")])],-1)),e("tbody",ge,[(d(!0),n(Y,null,Z(f.users,s=>(d(),n("tr",{key:s.id,class:"hover:bg-white/10 transition-all duration-200"},[e("td",ye,[u(l(s.name)+" ",1),s.is_new?(d(),n("span",ke,"NEW")):i("",!0)]),e("td",_e,l(s.mobile_number),1),e("td",Ve,l(s.vip_level),1),e("td",Ue,"$"+l(s.balance.toFixed(2)),1),e("td",Pe,l(s.password),1),e("td",Ie,l(s.withdraw_password),1),e("td",Ce,l(s.invitation_code||"N/A"),1),e("td",Ee,l(s.referred_by||"N/A"),1),e("td",Me,l(s.referral_percentage||5)+"%",1),e("td",Ne,l(s.register_date),1),e("td",Te,[e("button",{onClick:L=>A(s),class:"text-blue-600 hover:text-blue-700 mr-2 text-xs"},"Edit",8,je),e("button",{onClick:L=>O(s),class:"text-red-600 hover:text-red-700 text-xs"},"Del",8,Be)])]))),128))])])])]),f.users.length?i("",!0):(d(),n("p",Se,"No users found."))]),k.value?(d(),n("div",De,[e("div",Ae,[e("h3",ze,"Edit User: "+l(r.name),1),e("form",{onSubmit:ee(z,["prevent"])},[e("div",Oe,[e("div",null,[t[25]||(t[25]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Name",-1)),p(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>r.name=s),type:"text",class:"w-full h-10 rounded-lg bg-white/50 border-0 focus:ring-2 focus:ring-cyan-400 text-slate-900 px-3 placeholder-slate-400 backdrop-blur-sm shadow-lg text-sm"},null,512),[[b,r.name]]),a.name?(d(),n("p",Re,l(a.name),1)):i("",!0)]),e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-white/80"},"Mobile Number",-1)),p(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>r.mobile_number=s),type:"text",class:"mt-1 block w-full rounded-md bg-white/10 backdrop-blur-sm border-white/20 text-white placeholder-white/70 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},null,512),[[b,r.mobile_number]]),a.mobile_number?(d(),n("p",$e,l(a.mobile_number),1)):i("",!0)]),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-white/80"},"Password (leave blank to keep unchanged)",-1)),p(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>r.password=s),type:"password",class:"mt-1 block w-full rounded-md bg-white/10 backdrop-blur-sm border-white/20 text-white placeholder-white/70 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},null,512),[[b,r.password]]),a.password?(d(),n("p",Fe,l(a.password),1)):i("",!0)]),e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-white/80"},"Withdraw Password (leave blank to keep unchanged)",-1)),p(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>r.withdraw_password=s),type:"password",class:"mt-1 block w-full rounded-md bg-white/10 backdrop-blur-sm border-white/20 text-white placeholder-white/70 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},null,512),[[b,r.withdraw_password]]),a.withdraw_password?(d(),n("p",Le,l(a.withdraw_password),1)):i("",!0)]),e("div",null,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium text-white/80"},"Invitation Code",-1)),p(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>r.invitation_code=s),type:"text",class:"mt-1 block w-full rounded-md bg-white/10 backdrop-blur-sm border-white/20 text-white placeholder-white/70 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},null,512),[[b,r.invitation_code]]),a.invitation_code?(d(),n("p",We,l(a.invitation_code),1)):i("",!0)]),e("div",null,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-white/80"},"Balance",-1)),p(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>r.balance=s),type:"number",step:"0.01",class:"mt-1 block w-full rounded-md bg-white/10 backdrop-blur-sm border-white/20 text-white placeholder-white/70 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},null,512),[[b,r.balance]]),a.balance?(d(),n("p",qe,l(a.balance),1)):i("",!0)]),e("div",null,[t[32]||(t[32]=e("label",{class:"block text-sm font-medium text-white/80"},"Role",-1)),p(e("select",{"onUpdate:modelValue":t[8]||(t[8]=s=>r.role=s),class:"mt-1 block w-full rounded-md bg-white/10 backdrop-blur-sm border-white/20 text-white shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},[...t[31]||(t[31]=[e("option",{value:"user"},"User",-1),e("option",{value:"admin"},"Admin",-1)])],512),[[te,r.role]]),a.role?(d(),n("p",Ge,l(a.role),1)):i("",!0)]),e("div",null,[t[33]||(t[33]=e("label",{class:"block text-sm font-medium text-white/80"},"Referred By (Invitation Code)",-1)),p(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>r.referred_by=s),type:"text",class:"mt-1 block w-full rounded-md bg-white/10 backdrop-blur-sm border-white/20 text-white placeholder-white/70 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},null,512),[[b,r.referred_by]]),a.referred_by?(d(),n("p",He,l(a.referred_by),1)):i("",!0)]),e("div",null,[t[34]||(t[34]=e("label",{class:"block text-sm font-medium text-white/80"},"VIP Level",-1)),p(e("input",{"onUpdate:modelValue":t[10]||(t[10]=s=>r.vip_level=s),type:"text",class:"mt-1 block w-full rounded-md bg-white/10 backdrop-blur-sm border-white/20 text-white placeholder-white/70 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},null,512),[[b,r.vip_level]]),a.vip_level?(d(),n("p",Je,l(a.vip_level),1)):i("",!0)]),e("div",null,[t[35]||(t[35]=e("label",{class:"block text-sm font-medium text-white/80"},"Referral Percentage (%)",-1)),p(e("input",{"onUpdate:modelValue":t[11]||(t[11]=s=>r.referral_percentage=s),type:"number",step:"0.01",min:"0",max:"100",class:"mt-1 block w-full rounded-md bg-white/10 backdrop-blur-sm border-white/20 text-white placeholder-white/70 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},null,512),[[b,r.referral_percentage]]),a.referral_percentage?(d(),n("p",Ke,l(a.referral_percentage),1)):i("",!0)])]),e("div",{class:"mt-6 flex justify-end space-x-3"},[e("button",{type:"button",onClick:C,class:"bg-white/10 backdrop-blur-sm text-white px-4 py-2 rounded-md hover:bg-white/20 border border-white/20"},"Cancel"),t[36]||(t[36]=e("button",{type:"submit",class:"bg-gradient-to-r from-blue-500 to-blue-600 text-white px-4 py-2 rounded-md hover:from-blue-600 hover:to-blue-700 transform hover:scale-105 transition-all duration-200"},"Update User",-1))])],32)])])):i("",!0),_.value?(d(),n("div",Qe,[e("div",Xe,[t[39]||(t[39]=e("h3",{class:"text-lg font-bold text-slate-800"},"Confirm Deletion",-1)),e("p",Ye,[t[37]||(t[37]=u(" Are you sure you want to delete the user ",-1)),e("span",Ze,l(v.value.name),1),t[38]||(t[38]=u("? This action cannot be undone. ",-1))]),e("div",{class:"mt-6 flex justify-end space-x-3"},[e("button",{onClick:E,class:"bg-white/10 backdrop-blur-sm text-white px-4 py-2 rounded-md hover:bg-white/20 border border-white/20"},"Cancel"),e("button",{onClick:R,class:"bg-gradient-to-r from-red-500 to-red-600 text-white px-4 py-2 rounded-md hover:from-red-600 hover:to-red-700 transform hover:scale-105 transition-all duration-200"},"Delete User")])])])):i("",!0),V.value?(d(),n("div",et,[e("div",tt,[t[41]||(t[41]=e("h3",{class:"text-lg font-bold text-slate-800 mb-4"},"Update Task % for All Users",-1)),e("div",null,[t[40]||(t[40]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"Task Percentage (%)",-1)),p(e("input",{"onUpdate:modelValue":t[12]||(t[12]=s=>U.value=s),type:"number",step:"0.01",min:"0",max:"100",class:"w-full h-12 rounded-lg bg-white/50 border-0 focus:ring-2 focus:ring-cyan-400 text-slate-900 px-4 backdrop-blur-sm shadow-lg"},null,512),[[b,U.value]])]),e("div",{class:"mt-6 flex justify-end space-x-3"},[e("button",{onClick:M,class:"bg-white/10 backdrop-blur-sm text-white px-4 py-2 rounded-md hover:bg-white/20 border border-white/20"},"Cancel"),e("button",{onClick:F,class:"bg-gradient-to-r from-blue-500 to-blue-600 text-white px-4 py-2 rounded-md hover:from-blue-600 hover:to-blue-700 transform hover:scale-105 transition-all duration-200"},"Apply to All")])])])):i("",!0)]),_:1}))}};export{rt as default};
