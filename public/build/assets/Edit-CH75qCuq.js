import{u as X,c as U,G as J,r as d,q as K,s as Y,a as m,b as p,d as f,h as Q,w as x,e,k as B,t as l,y as F,l as w,g as Z,o as g,F as N,j as ee,n as P}from"./app-CdvAI5iq.js";import{_ as te}from"./AuthenticatedLayout-DBI621vr.js";const oe={class:"bg-gradient-to-br from-cyan-400/20 via-blue-500/15 to-indigo-600/20 backdrop-blur-xl p-4 sm:p-6 rounded-2xl sm:rounded-3xl shadow-2xl border border-cyan-300/30 h-full overflow-y-auto flex items-center justify-center"},se={class:"w-full"},ae={class:"space-y-4"},re={class:"flex items-center space-x-3 bg-gradient-to-br from-cyan-400/20 via-blue-500/15 to-indigo-600/20 backdrop-blur-xl p-4 sm:p-6 rounded-2xl sm:rounded-3xl shadow-2xl border border-cyan-300/30"},le={class:"relative"},ne=["src","alt"],ie=["title"],de={class:"flex-1"},ce={class:"flex items-center"},ue={class:"text-lg font-semibold text-slate-800 leading-none drop-shadow-sm"},ve={class:"ml-3 inline-flex items-center justify-center bg-gradient-to-r from-slate-800 to-slate-900 text-white text-xs font-semibold rounded-full px-3 py-1 shadow-lg"},he={class:"text-sm font-medium text-slate-600 leading-none mt-1 drop-shadow-sm"},pe={class:"flex items-center mt-2"},fe={class:"text-xs text-slate-600 drop-shadow-sm"},xe=["title"],be={class:"flex justify-between space-x-2 bg-gradient-to-br from-cyan-400/20 via-blue-500/15 to-indigo-600/20 backdrop-blur-xl p-4 sm:p-6 rounded-2xl sm:rounded-3xl shadow-2xl border border-cyan-300/30"},me={class:"text-center"},we={class:"text-xs font-medium text-slate-600 drop-shadow-sm"},ge={class:"text-sm font-semibold text-slate-800 drop-shadow-sm"},_e={class:"text-center"},ke={class:"text-xs font-medium text-slate-600 drop-shadow-sm"},ye={class:"text-sm font-semibold text-slate-800 drop-shadow-sm"},je={class:"bg-gradient-to-br from-cyan-400/20 via-blue-500/15 to-indigo-600/20 backdrop-blur-xl rounded-2xl shadow-2xl border border-cyan-300/30 overflow-hidden"},Ce={class:"divide-y divide-white/20"},Ue={class:"flex items-center space-x-3"},Be={class:"group-hover:text-slate-900 transition-colors"},Le={class:"flex items-center space-x-3"},Me={class:"group-hover:text-slate-900 transition-colors"},Re={class:"flex items-center space-x-3"},Ae={class:"group-hover:text-slate-900 transition-colors"},Ee={class:"flex items-center space-x-3"},ze={class:"group-hover:text-slate-900 transition-colors"},Fe={class:"flex items-center space-x-3"},Ne={class:"group-hover:text-slate-900 transition-colors"},Pe={class:"p-4 border-t border-white/20"},Se={type:"submit",class:"w-full rounded-xl px-4 py-3 bg-gradient-to-r from-red-500/80 to-red-600/80 hover:from-red-600/90 hover:to-red-700/90 text-white font-medium text-sm text-center transition-all duration-300 transform hover:scale-[1.02] shadow-lg hover:shadow-xl"},Ve={key:0,class:"fixed inset-0 z-50 flex items-start justify-center bg-black/50 backdrop-blur-sm p-4 pt-8 sm:pt-16"},Oe={class:"bg-gradient-to-br from-white/95 via-blue-50/90 to-indigo-50/95 backdrop-blur-xl rounded-2xl w-full max-w-sm p-4 shadow-2xl border border-white/40"},De={class:"flex items-center justify-between mb-4"},He={class:"text-base font-semibold text-slate-800"},Te={key:0,class:"mb-3 text-xs text-red-600 bg-red-50 p-2 rounded-lg"},$e={class:"grid grid-cols-4 gap-2 mb-4"},Ie=["onClick"],We=["src","alt"],qe={key:0,class:"absolute inset-0 bg-cyan-500 bg-opacity-20 flex items-center justify-center"},Ge={class:"border-t border-white/30 pt-3 mb-4"},Xe={class:"text-sm font-medium text-slate-700 mb-3"},Je={class:"flex items-center space-x-3 mb-3"},Ke={class:"w-12 h-12 rounded-full overflow-hidden border border-white/40 bg-white/50 flex-shrink-0"},Ye=["src","alt"],Qe={class:"flex-1"},Ze={class:"text-xs text-slate-500 mb-3"},et={class:"flex justify-end space-x-2"},tt=["disabled"],ot=["disabled"],L="https://placehold.co/128x128?text=Avatar",nt={__name:"Edit",setup(st){const _=X(),S=U(()=>_.props.translations||{});U(()=>_.props.locale||"en");const s=t=>S.value[t]||t,a=J({...{id:null,vip_level:"VIP1",mobile_number:s("Not set"),invitation_code:s("Not set"),frozen_balance:0,avatar_url:null},..._.props.user}),y=d(0),V=d(Number(a.frozen_balance??0)),k=d(!1),c=d(!1),u=d(""),v=d(null),i=d(""),j=d(!1),O=["/assets/avatar/boys/1.jpg","/assets/avatar/boys/2.jpg","/assets/avatar/boys/3.jpg","/assets/avatar/boys/4.jpg","/assets/avatar/boys/5.jpg","/assets/avatar/boys/6.jpg","/assets/avatar/girls/1.jpg","/assets/avatar/girls/2.jpg","/assets/avatar/girls/3.jpg","/assets/avatar/girls/4.jpg","/assets/avatar/girls/5.jpg","/assets/avatar/girls/6.jpg"],b=d(null),n=d(a.avatar_url||null),C=U(()=>a.avatar_url||n.value||L);function D(t){if(t&&t.target&&(t.target.src=L),n.value&&typeof n.value=="string"&&n.value.startsWith("blob:")){try{URL.revokeObjectURL(n.value)}catch{}n.value=null}}function M(t){t&&t.target&&(t.target.src=C.value||L)}function H(){const t=a.invitation_code||"";t&&navigator.clipboard.writeText(t).then(()=>{j.value=!0}).catch(()=>{const o=document.createElement("textarea");o.value=t,document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o),j.value=!0})}function T(){k.value=!0}function R(){k.value=!1,u.value="",c.value=!1,i.value&&URL.revokeObjectURL(i.value),v.value=null,i.value="",b.value=null}function $(t){var r,h;const o=(h=(r=t==null?void 0:t.target)==null?void 0:r.files)==null?void 0:h[0];o&&(v.value=o,i.value&&URL.revokeObjectURL(i.value),i.value=URL.createObjectURL(o),b.value=null)}async function I(t){try{const r=await(await fetch(t)).blob(),h=t.split("/").pop(),E=new File([r],h,{type:r.type});v.value=E,i.value&&URL.revokeObjectURL(i.value),i.value=URL.createObjectURL(r),b.value=t;const z=document.querySelector('input[type="file"]');z&&(z.value="")}catch(o){console.error("Error loading default avatar:",o),u.value=s("Failed to load avatar. Please try again.")}}async function W(){if(v.value){c.value=!0,u.value="";try{const t=new FormData;t.append("avatar",v.value),await P.post(route("profile.avatar"),t,{preserveState:!0,preserveScroll:!0,onSuccess:()=>{i.value&&(n.value=i.value),a.avatar_url=void 0,v.value=null,i.value="",k.value=!1,c.value=!1,A()},onError:o=>{c.value=!1,u.value=(o==null?void 0:o.avatar)||s("Failed to upload avatar. Please try again.")}})}catch(t){c.value=!1,u.value=`${s("Failed to upload avatar:")} ${(t==null?void 0:t.message)||t}`}}}const A=async()=>{var t;if((t=_.props.auth)!=null&&t.user)try{const o=await fetch(route("balance"),{headers:{Accept:"application/json"}});if(!o.ok)throw new Error(`HTTP error ${o.status}`);const r=await o.json();if(y.value=Number(r.balance??0),a.vip_level=r.vip_level??a.vip_level,r.avatar_url){if(n.value&&typeof n.value=="string"&&n.value.startsWith("blob:"))try{URL.revokeObjectURL(n.value)}catch{}a.avatar_url=r.avatar_url,n.value=r.avatar_url}}catch{}};K(()=>{A(),window!=null&&window.Echo&&(a!=null&&a.id)&&window.Echo.private(`user.${a.id}`).listen("BalanceUpdated",t=>{t&&t.balance!==void 0&&(y.value=Number(t.balance))}).listen("VipLevelUpdated",t=>{t&&t.vip_level!==void 0&&(a.vip_level=t.vip_level)}).listen("AvatarUpdated",t=>{if(t&&t.avatar_url){if(n.value&&typeof n.value=="string"&&n.value.startsWith("blob:"))try{URL.revokeObjectURL(n.value)}catch{}a.avatar_url=t.avatar_url,n.value=t.avatar_url}})}),Y(()=>{window!=null&&window.Echo&&(a!=null&&a.id)&&window.Echo.leave(`user.${a.id}`)});const q=async()=>{const r=(await(await fetch(route("csrf-token"),{method:"GET",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"})).json()).token;document.head.querySelector('meta[name="csrf-token"]').content=r,window.axios.defaults.headers.common["X-CSRF-TOKEN"]=r},G=async()=>{try{await q(),await P.post(route("logout"))}catch(t){t.response&&t.response.status===419&&window.location.reload()}};return(t,o)=>(g(),m(N,null,[p(f(Q),{title:s("Profile")},null,8,["title"]),p(te,null,{default:x(()=>[e("div",oe,[e("div",se,[e("section",ae,[e("div",re,[e("div",le,[e("img",{src:C.value,alt:s("Avatar"),class:"w-16 h-16 rounded-full object-cover border",onError:D},null,40,ne),e("button",{onClick:T,class:"absolute -bottom-1 -right-1 bg-gradient-to-br from-white/95 to-blue-50/90 border border-cyan-300/30 rounded-full p-1 shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105 backdrop-blur-sm",title:s("Change avatar")},[...o[0]||(o[0]=[e("svg",{class:"w-4 h-4 text-blue-600",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536M9 11l6-6 3 3L12 14l-3 1 1-3z"})],-1)])],8,ie)]),e("div",de,[e("div",ce,[e("h3",ue,l((a==null?void 0:a.name)||s("Not set")),1),e("span",ve,l(a.vip_level||"VIP1"),1)]),e("p",he,l((a==null?void 0:a.mobile_number)||s("Not set")),1),e("div",pe,[e("p",fe,l(s("Invitation Code"))+": "+l((a==null?void 0:a.invitation_code)||s("Not set")),1),e("button",{onClick:H,class:F([j.value?"text-cyan-600":"text-slate-600","ml-2 hover:text-cyan-700 transition-colors duration-200"]),title:s("Copy Invitation Code")},[...o[1]||(o[1]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)])],10,xe)])])]),e("div",be,[e("div",me,[e("p",we,l(s("Available Balance")),1),e("p",ge,l(y.value.toFixed(2))+" USDT ",1)]),e("div",_e,[e("p",ke,l(s("Frozen Balance")),1),e("p",ye,l(V.value.toFixed(2))+" USDT ",1)])]),e("div",je,[e("nav",Ce,[p(f(w),{href:t.route("profile.edit"),class:"flex items-center justify-between w-full py-4 px-5 text-slate-800 text-sm font-medium hover:bg-white/20 transition-all duration-300 group"},{default:x(()=>[e("div",Ue,[o[2]||(o[2]=e("svg",{class:"w-5 h-5 text-blue-600 group-hover:text-blue-700 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)),e("span",Be,l(s("Edit Profile")),1)]),o[3]||(o[3]=e("svg",{class:"w-4 h-4 text-slate-500 group-hover:text-slate-700 group-hover:translate-x-1 transition-all",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))]),_:1},8,["href"]),p(f(w),{href:t.route("balance.records"),class:"flex items-center justify-between w-full py-4 px-5 text-slate-800 text-sm font-medium hover:bg-white/20 transition-all duration-300 group"},{default:x(()=>[e("div",Le,[o[4]||(o[4]=e("svg",{class:"w-5 h-5 text-blue-600 group-hover:text-blue-700 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})],-1)),e("span",Me,l(s("Balance Record")),1)]),o[5]||(o[5]=e("svg",{class:"w-4 h-4 text-slate-500 group-hover:text-slate-700 group-hover:translate-x-1 transition-all",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))]),_:1},8,["href"]),p(f(w),{href:t.route("withdraw"),class:"flex items-center justify-between w-full py-4 px-5 text-slate-800 text-sm font-medium hover:bg-white/20 transition-all duration-300 group"},{default:x(()=>[e("div",Re,[o[6]||(o[6]=e("svg",{class:"w-5 h-5 text-blue-600 group-hover:text-blue-700 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})],-1)),e("span",Ae,l(s("Withdraw")),1)]),o[7]||(o[7]=e("svg",{class:"w-4 h-4 text-slate-500 group-hover:text-slate-700 group-hover:translate-x-1 transition-all",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))]),_:1},8,["href"]),p(f(w),{href:t.route("withdraw.history"),class:"flex items-center justify-between w-full py-4 px-5 text-slate-800 text-sm font-medium hover:bg-white/20 transition-all duration-300 group"},{default:x(()=>[e("div",Ee,[o[8]||(o[8]=e("svg",{class:"w-5 h-5 text-blue-600 group-hover:text-blue-700 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),e("span",ze,l(s("Withdraw History")),1)]),o[9]||(o[9]=e("svg",{class:"w-4 h-4 text-slate-500 group-hover:text-slate-700 group-hover:translate-x-1 transition-all",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))]),_:1},8,["href"]),p(f(w),{href:t.route("password.change"),class:"flex items-center justify-between w-full py-4 px-5 text-slate-800 text-sm font-medium hover:bg-white/20 transition-all duration-300 group"},{default:x(()=>[e("div",Fe,[o[10]||(o[10]=e("svg",{class:"w-5 h-5 text-blue-600 group-hover:text-blue-700 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})],-1)),e("span",Ne,l(s("Change Password")),1)]),o[11]||(o[11]=e("svg",{class:"w-4 h-4 text-slate-500 group-hover:text-slate-700 group-hover:translate-x-1 transition-all",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))]),_:1},8,["href"])]),e("div",Pe,[e("form",{onSubmit:Z(G,["prevent"]),class:"w-full"},[e("button",Se,l(s("Log Out")),1)],32)])])])])]),k.value?(g(),m("div",Ve,[e("div",Oe,[e("div",De,[e("h3",He,l(s("Choose an Avatar")),1),e("button",{onClick:R,class:"text-slate-500 hover:text-slate-700"},[...o[12]||(o[12]=[e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),u.value?(g(),m("div",Te,l(u.value),1)):B("",!0),e("div",$e,[(g(),m(N,null,ee(O,(r,h)=>e("div",{key:r,onClick:E=>I(r),class:F(["relative cursor-pointer rounded-lg overflow-hidden border-2 transition-all duration-200 hover:scale-105",b.value===r?"border-cyan-500 ring-1 ring-cyan-200":"border-white/40"])},[e("img",{src:r,alt:`Avatar ${h+1}`,class:"w-full h-12 object-cover",onError:M},null,40,We),b.value===r?(g(),m("div",qe,[...o[13]||(o[13]=[e("svg",{class:"w-4 h-4 text-cyan-600",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})],-1)])])):B("",!0)],10,Ie)),64))]),e("div",Ge,[e("h4",Xe,l(s("Or upload your own")),1),e("div",Je,[e("div",Ke,[e("img",{src:i.value||C.value,alt:s("Avatar preview"),class:"w-full h-full object-cover",onError:M},null,40,Ye)]),e("div",Qe,[e("input",{type:"file",accept:"image/*",capture:"user",onChange:$,class:"block w-full text-xs"},null,32)])]),e("p",Ze,l(s("PNG, JPG, or WEBP up to 5MB. You can take a photo on mobile.")),1)]),e("div",et,[e("button",{onClick:R,class:"px-3 py-2 text-xs border border-white/40 rounded-lg bg-white/50 hover:bg-white/70 transition-all",disabled:c.value},l(s("Cancel")),9,tt),e("button",{onClick:W,class:"px-3 py-2 text-xs bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-600 hover:to-blue-700 text-white rounded-lg disabled:opacity-50 transition-all shadow-lg",disabled:c.value||!v.value},l(c.value?s("Saving..."):s("Save")),9,ot)])])])):B("",!0)]),_:1})],64))}};export{nt as default};
