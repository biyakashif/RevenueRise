import{u as M,r as n,q as N,s as A,a as l,b as C,d as D,h as $,w as X,e,k as b,i as T,m as j,o as i,F as f,j as S,A as g,t as r,y as O,g as I,H as P,n as V}from"./app-D6hQSsMw.js";import{_ as q}from"./AdminLayout-DLZ9ec3C.js";const B={class:"bg-gradient-to-br from-cyan-400/20 via-blue-500/15 to-indigo-600/20 backdrop-blur-xl p-4 rounded-2xl shadow-2xl border border-cyan-300/30 h-full overflow-y-auto"},H={class:"flex items-center justify-between mb-4"},z={class:"w-1/3"},K={class:"flex justify-between items-start"},J={class:"font-semibold text-slate-800 text-sm"},Q={class:"text-xs text-slate-600"},Y={class:"text-xs text-slate-600 mt-1"},G={class:"text-slate-800"},Z=["onClick"],tt={class:"mt-2 space-y-2"},et={class:"flex justify-between"},ot={class:"flex items-center gap-2 mb-1"},st={class:"text-sm text-slate-800 font-semibold"},at={key:0,class:"px-2 py-0.5 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-full text-xs font-medium shadow-sm"},rt={class:"text-xs text-slate-600 mb-1"},lt={class:"text-xs text-slate-500"},it={class:"flex flex-col items-end space-y-2"},nt={class:"flex space-x-2"},dt=["onClick"],ut=["onClick"],ct=["onClick"],mt={class:"mb-4"},pt={key:0,class:"text-sm text-red-600 mb-4 bg-red-100/80 p-2 rounded-lg"},ht={class:"flex justify-end space-x-2"},vt={__name:"Withdrawals",setup(bt){const x=M(),y=n([]);n(1),n(1);const d=n("");let _=null;const p=async(s="")=>{try{const t=s?`/admin/withdrawals?search=${encodeURIComponent(s)}`:"/admin/withdrawals",a=await fetch(t,{headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`HTTP ${a.status}`);const o=await a.json();y.value=(o.data||[]).map(u=>({...u,withdraw_limit:m(u.withdraw_limit)}))}catch{}};N(()=>{p(d.value),_=setInterval(()=>p(d.value),4e3)}),A(()=>{clearInterval(_)});const U=()=>{p(d.value)},L=async s=>{try{const t=await fetch(route("admin.withdrawals.approve",s),{method:"POST",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":x.props.csrf_token}});if(!t.ok){if(t.status===419){window.location.reload();return}throw new Error("Approve failed")}await p(d.value)}catch{}},R=async s=>{try{const t=await fetch(route("admin.withdrawals.reject",s),{method:"POST",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":x.props.csrf_token}});if(!t.ok){if(t.status===419){window.location.reload();return}throw new Error("Reject failed")}await p(d.value)}catch{}},W=s=>{V.visit(route("admin.withdrawals.edit",s))},h=n(!1),k=n(null),w=n(""),c=n(""),v=n({top:0,left:0}),E=(s,t,a)=>{k.value=s,w.value=t;const o=a.target.getBoundingClientRect();v.value={top:o.bottom+window.scrollY+10,left:Math.max(10,o.left+window.scrollX-200)},h.value=!0,c.value=""},m=s=>{if(s==null||s==="")return"0.00";const t=Number(s);return isFinite(t)?t.toFixed(2):"0.00"},F=async()=>{c.value="";try{const s=await fetch(route("admin.users.withdraw-limit.update",k.value),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":x.props.csrf_token},body:JSON.stringify({withdraw_limit:m(w.value)})}),t=await s.json();if(!s.ok){if(s.status===419){window.location.reload();return}throw new Error(t.message||"Failed to update withdraw limit")}h.value=!1,await p(d.value)}catch(s){c.value=s.message||"Failed to update withdraw limit",setTimeout(()=>c.value="",5e3)}};return(s,t)=>(i(),l(f,null,[C(D($),{title:"Withdrawals"}),C(q,null,{default:X(()=>[e("div",B,[e("div",H,[t[6]||(t[6]=e("h1",{class:"text-lg font-bold text-slate-800 drop-shadow-sm"},"Withdrawals",-1)),e("div",z,[T(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>d.value=a),onInput:U,type:"text",placeholder:"Search name, mobile or code...",class:"w-full h-10 rounded-xl bg-white/50 border-0 focus:ring-2 focus:ring-cyan-400 text-slate-900 px-4 placeholder-slate-400 backdrop-blur-sm shadow-lg"},null,544),[[j,d.value]])])]),(i(!0),l(f,null,S(y.value,a=>(i(),l("div",{key:a.id,class:"mb-4 bg-white/20 backdrop-blur-sm p-4 rounded-xl shadow-lg border border-white/30"},[e("div",K,[e("div",null,[e("h3",J,[g(r(a.name)+" ",1),e("span",Q,"â€” "+r(a.mobile_number)+" / "+r(a.invitation_code),1)]),e("div",Y,[t[7]||(t[7]=g(" Withdraw Limit: ",-1)),e("strong",G,r(m(a.withdraw_limit)),1),t[8]||(t[8]=g(" USDT ",-1)),e("button",{onClick:o=>E(a.id,m(a.withdraw_limit),o),class:"ml-2 text-xs bg-white/20 backdrop-blur-sm px-2 py-1 rounded-lg hover:bg-white/30 transition-colors text-slate-700 border border-white/30"}," Change Limit ",8,Z)])])]),e("div",tt,[(i(!0),l(f,null,S(a.withdraws,o=>(i(),l("div",{key:o.id,class:"bg-white/10 backdrop-blur-sm p-3 rounded-lg border border-white/20"},[e("div",et,[e("div",null,[e("div",ot,[e("span",st,r(m(o.amount_withdraw))+" USDT",1),o.crypto_symbol&&o.crypto_symbol!=="USDT"?(i(),l("span",at,r(o.crypto_amount?o.crypto_symbol==="USDT"?m(o.crypto_amount):Number(o.crypto_amount).toFixed(6):m(o.amount_withdraw))+" "+r(o.crypto_symbol),1)):b("",!0)]),e("div",rt,"To: "+r(o.crypto_wallet),1),e("div",lt,r(new Date(o.created_at).toLocaleString()),1)]),e("div",it,[e("div",null,[e("span",{class:O({"px-2 py-1 rounded text-xs":!0,"bg-yellow-100 text-yellow-800":o.status==="under review","bg-green-100 text-green-800":o.status==="approved","bg-red-100 text-red-800":o.status==="rejected"})},r(o.status.split(" ").map(u=>u.charAt(0).toUpperCase()+u.slice(1)).join(" ")),3)]),e("div",nt,[o.status==="under review"?(i(),l("button",{key:0,onClick:u=>L(o.id),class:"bg-gradient-to-r from-green-500 to-green-600 text-white px-3 py-1 rounded text-xs hover:from-green-600 hover:to-green-700 transform hover:scale-105 transition-all duration-200"},"Approve",8,dt)):b("",!0),o.status==="under review"?(i(),l("button",{key:1,onClick:u=>R(o.id),class:"bg-gradient-to-r from-red-500 to-red-600 text-white px-3 py-1 rounded text-xs hover:from-red-600 hover:to-red-700 transform hover:scale-105 transition-all duration-200"},"Reject",8,ut)):b("",!0),e("button",{onClick:u=>W(o.id),class:"bg-gradient-to-r from-blue-500 to-blue-600 text-white px-3 py-1 rounded text-xs hover:from-blue-600 hover:to-blue-700 transform hover:scale-105 transition-all duration-200"},"Edit",8,ct)])])])]))),128))])]))),128))]),h.value?(i(),l("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-40 z-50",onClick:t[5]||(t[5]=a=>h.value=!1)},[e("div",{class:"absolute bg-gradient-to-br from-cyan-400/20 via-blue-500/15 to-indigo-600/20 backdrop-blur-xl rounded-lg p-6 w-full max-w-md border border-white/20",style:P({top:v.value.top+"px",left:v.value.left+"px"}),onClick:t[4]||(t[4]=I(()=>{},["stop"]))},[t[10]||(t[10]=e("h3",{class:"text-lg font-semibold mb-4 text-slate-800"},"Update Withdraw Limit",-1)),e("div",mt,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"Minimum Withdraw Amount (USDT)",-1)),T(e("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>w.value=a),type:"number",step:"0.01",class:"w-full h-10 rounded-lg bg-white/50 border-0 focus:ring-2 focus:ring-cyan-400 text-slate-900 px-3 placeholder-slate-400 backdrop-blur-sm shadow-lg",min:"0.01"},null,512),[[j,w.value]])]),c.value?(i(),l("div",pt,r(c.value),1)):b("",!0),e("div",ht,[e("button",{onClick:t[2]||(t[2]=a=>{h.value=!1,c.value=""}),class:"px-4 py-2 bg-white/20 backdrop-blur-sm rounded-lg text-sm hover:bg-white/30 text-slate-700 border border-white/30"}," Cancel "),e("button",{onClick:t[3]||(t[3]=a=>F()),class:"px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded text-sm hover:from-blue-600 hover:to-blue-700 transform hover:scale-105 transition-all duration-200"}," Update ")])],4)])):b("",!0)]),_:1})],64))}};export{vt as default};
