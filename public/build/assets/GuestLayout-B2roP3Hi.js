import{u as F,c as g,r as m,a as h,o as u,e,b as f,w as $,d as S,l as E,k as I,t as r,F as q,j as z,n as G,J as B,x as L,z as R,p as D,g as M,i as k,m as C,D as V}from"./app-B9zrzIaV.js";import{_ as T,a as P,b as U}from"./GuestChatInterface-B_DKqzvI.js";const X={class:"bg-white/10 backdrop-blur-md border-b border-white/20 shadow-lg relative z-50"},A={class:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8"},H={class:"flex flex-row justify-between items-center h-16"},O={class:"relative"},Y=["src"],J={class:"text-sm"},K={key:0,class:"absolute right-0 mt-2 w-40 bg-white/95 backdrop-blur-md border border-white/30 rounded-lg shadow-xl z-[9999]"},W=["onClick"],Q=["src","alt"],Z={__name:"Header",setup(N){const p=F(),x=g(()=>p.props.translations||{}),y=g(()=>p.props.auth||{}),s=g(()=>p.props.locale||"en"),i=[{code:"en",name:"English",flag:"https://flagcdn.com/w20/gb.png"},{code:"es",name:"Español",flag:"https://flagcdn.com/w20/es.png"},{code:"it",name:"Italiano",flag:"https://flagcdn.com/w20/it.png"},{code:"ro",name:"Română",flag:"https://flagcdn.com/w20/ro.png"},{code:"ru",name:"Русский",flag:"https://flagcdn.com/w20/ru.png"},{code:"de",name:"Deutsch",flag:"https://flagcdn.com/w20/de.png"},{code:"bn",name:"বাংলা",flag:"https://flagcdn.com/w20/bd.png"},{code:"hi",name:"हिन्दी",flag:"https://flagcdn.com/w20/in.png"}],v=g(()=>i.find(o=>o.code===s.value)||i[0]),t=m(!1),w=async()=>{const l=(await(await fetch(route("csrf-token"),{method:"GET",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"})).json()).token;document.head.querySelector('meta[name="csrf-token"]').content=l,window.axios.defaults.headers.common["X-CSRF-TOKEN"]=l},_=async o=>{try{await w(),await G.post(route("locale.change"),{locale:o},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{t.value=!1}})}catch(n){n.response&&n.response.status===419?window.location.reload():console.error("Failed to change language:",n)}},d=o=>x.value[o]||o;return(o,n)=>(u(),h("header",X,[e("div",A,[e("div",H,[f(S(E),{href:y.value.user?o.route("dashboard"):o.route("welcome")},{default:$(()=>[f(T,{class:"block h-9 w-auto fill-current text-white"})]),_:1},8,["href"]),e("div",O,[e("button",{onClick:n[0]||(n[0]=l=>t.value=!t.value),class:"flex items-center px-3 py-2 rounded-lg text-white font-semibold transition-all duration-300 hover:bg-white/10 hover:scale-105"},[e("img",{src:v.value.flag,alt:"Lang",class:"h-4 w-auto mr-2 rounded-sm"},null,8,Y),e("span",J,r(d("Language")),1),n[1]||(n[1]=e("svg",{class:"ml-1 h-4 w-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))]),t.value?(u(),h("div",K,[e("ul",null,[(u(),h(q,null,z(i,l=>e("li",{key:l.code},[e("button",{onClick:j=>_(l.code),class:"flex items-center w-full px-3 py-2 text-sm text-gray-800 font-medium hover:bg-blue-50 transition-all duration-300 first:rounded-t-lg last:rounded-b-lg"},[e("img",{src:l.flag,alt:l.name,class:"h-4 w-auto mr-2 rounded-sm"},null,8,Q),e("span",null,r(l.name),1)],8,W)])),64))])])):I("",!0)])])])]))}},ee={class:"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900"},te={class:"flex flex-col justify-center items-center p-4 min-h-[calc(100vh-64px)]"},se={class:"w-full max-w-md"},oe={class:"bg-white/10 backdrop-blur-md rounded-t-2xl p-1 border border-white/20 border-b-0"},ae={class:"flex"},le={key:0,class:"fixed inset-0 bg-black/50 z-50"},ne={key:0,class:"flex items-center justify-center h-full p-4"},re={class:"bg-white rounded-2xl shadow-2xl w-full max-w-md"},ce={class:"flex items-center justify-between p-4 border-b"},ue={class:"text-lg font-semibold text-gray-800"},ie={class:"p-6"},de={class:"block text-sm font-medium text-gray-700 mb-1"},me=["placeholder"],he={class:"block text-sm font-medium text-gray-700 mb-1"},pe=["placeholder"],be={class:"block text-sm font-medium text-gray-700 mb-1"},ge={class:"flex items-center space-x-2 mb-2"},fe=["src"],ve=["placeholder"],_e={key:0,class:"text-red-500 text-sm mt-1"},xe={type:"submit",class:"w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white py-2 px-4 rounded-lg transition-all duration-200"},ke={__name:"GuestLayout",setup(N){const p=F(),x=g(()=>p.url),y=g(()=>p.props.translations||{}),s=c=>y.value[c]||c,i=m(!1),v=m(!0),t=m({name:"",mobile_number:"",captcha:""}),w=m(""),_=m(null),d=m(""),o=()=>{w.value=`/captcha?${Date.now()}`},n=()=>{i.value=!0,o()},l=()=>{i.value=!1,v.value=!0,t.value={name:"",mobile_number:"",captcha:""},_.value=null},j=async()=>{try{if(!(await V.post("/captcha/verify",{captcha:t.value.captcha})).data.valid){d.value=s("Incorrect captcha. Please try again."),o(),t.value.captcha="";return}d.value="";const a=await V.post("/guest-chat/start",{name:t.value.name,mobile_number:t.value.mobile_number});if(a.data.blocked){d.value=s("You have been blocked. You cannot send messages.");return}_.value=a.data.session_id,v.value=!1}catch{alert(s("Error starting chat. Please try again."))}};return(c,a)=>(u(),h("div",ee,[f(Z,{class:"relative z-50"}),e("div",te,[e("div",se,[e("div",oe,[e("div",ae,[f(S(E),{href:c.route("register"),class:R(["flex-1 text-center py-3 px-4 rounded-t-xl text-sm font-semibold transition-all duration-300",x.value.includes("/register")?"bg-white text-blue-900 shadow-lg":"text-white/80 hover:text-white hover:bg-white/10"])},{default:$(()=>[L(r(s("Create Account")),1)]),_:1},8,["href","class"]),f(S(E),{href:c.route("login"),class:R(["flex-1 text-center py-3 px-4 rounded-t-xl text-sm font-semibold transition-all duration-300",x.value.includes("/login")?"bg-white text-blue-900 shadow-lg":"text-white/80 hover:text-white hover:bg-white/10"])},{default:$(()=>[L(r(s("Login")),1)]),_:1},8,["href","class"])])])]),B(c.$slots,"default")]),f(P,{onClick:n}),i.value?(u(),h("div",le,[v.value?(u(),h("div",ne,[e("div",re,[e("div",ce,[e("h3",ue,r(s("Contact Support")),1),e("button",{onClick:l,class:"text-gray-400 hover:text-gray-600"},[...a[4]||(a[4]=[e("i",{class:"fas fa-times text-xl"},null,-1)])])]),e("div",ie,[e("form",{onSubmit:M(j,["prevent"]),class:"space-y-4"},[e("div",null,[e("label",de,r(s("Name")),1),k(e("input",{"onUpdate:modelValue":a[0]||(a[0]=b=>t.value.name=b),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:s("Enter your name")},null,8,me),[[C,t.value.name]])]),e("div",null,[e("label",he,r(s("Mobile Number")),1),k(e("input",{"onUpdate:modelValue":a[1]||(a[1]=b=>t.value.mobile_number=b),type:"tel",required:"",pattern:"[0-9+\\-\\s]*",onInput:a[2]||(a[2]=b=>t.value.mobile_number=t.value.mobile_number.replace(/[^0-9+\-\s]/g,"")),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:s("Enter your mobile number")},null,40,pe),[[C,t.value.mobile_number]])]),e("div",null,[e("label",be,r(s("Verification")),1),e("div",ge,[e("img",{src:w.value,alt:"Captcha",class:"border border-gray-300 rounded",onClick:o,style:{cursor:"pointer"}},null,8,fe),e("button",{type:"button",onClick:o,class:"text-blue-500 hover:text-blue-700 text-sm"}," 🔄 ")]),k(e("input",{"onUpdate:modelValue":a[3]||(a[3]=b=>t.value.captcha=b),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:s("Enter the code shown above")},null,8,ve),[[C,t.value.captcha]]),d.value?(u(),h("div",_e,r(d.value),1)):I("",!0)]),e("button",xe,r(s("Start Chat")),1)],32)])])])):(u(),D(U,{key:1,sessionId:_.value,guestInfo:{name:t.value.name,mobile_number:t.value.mobile_number},onClose:l},null,8,["sessionId","guestInfo"]))])):I("",!0)]))}};export{ke as _};
