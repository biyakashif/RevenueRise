import{a as o,e,o as a,u as ue,c as S,r as u,q as de,s as ce,A as B,b as F,d as Y,h as ve,w as pe,k as p,t as r,H as me,F as z,j as ee,z as I,x as y,i as he,m as fe,n as xe}from"./app-DxfmXC0O.js";import{_ as be}from"./AuthenticatedLayout-jOjBsgM5.js";function ye(W,g){return a(),o("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M7.502 6h7.128A3.375 3.375 0 0 1 18 9.375v9.375a3 3 0 0 0 3-3V6.108c0-1.505-1.125-2.811-2.664-2.94a48.972 48.972 0 0 0-.673-.05A3 3 0 0 0 15 1.5h-1.5a3 3 0 0 0-2.663 1.618c-.225.015-.45.032-.673.05C8.662 3.295 7.554 4.542 7.502 6ZM13.5 3A1.5 1.5 0 0 0 12 4.5h4.5A1.5 1.5 0 0 0 15 3h-1.5Z","clip-rule":"evenodd"}),e("path",{"fill-rule":"evenodd",d:"M3 9.375C3 8.339 3.84 7.5 4.875 7.5h9.75c1.036 0 1.875.84 1.875 1.875v11.25c0 1.035-.84 1.875-1.875 1.875h-9.75A1.875 1.875 0 0 1 3 20.625V9.375ZM6 12a.75.75 0 0 1 .75-.75h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75H6.75a.75.75 0 0 1-.75-.75V12Zm2.25 0a.75.75 0 0 1 .75-.75h3.75a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1-.75-.75ZM6 15a.75.75 0 0 1 .75-.75h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75H6.75a.75.75 0 0 1-.75-.75V15Zm2.25 0a.75.75 0 0 1 .75-.75h3.75a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1-.75-.75ZM6 18a.75.75 0 0 1 .75-.75h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75H6.75a.75.75 0 0 1-.75-.75V18Zm2.25 0a.75.75 0 0 1 .75-.75h3.75a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1-.75-.75Z","clip-rule":"evenodd"})])}const ge={class:"bg-gradient-to-br from-cyan-400/20 via-blue-500/15 to-indigo-600/20 backdrop-blur-sm p-4 sm:p-6 rounded-2xl sm:rounded-3xl shadow-2xl border border-cyan-300/30 h-full overflow-y-auto"},_e={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},we={class:"bg-gradient-to-br from-cyan-400/20 via-blue-500/15 to-indigo-600/20 backdrop-blur-sm p-4 sm:p-6 rounded-2xl sm:rounded-3xl shadow-lg border border-cyan-300/30 w-full flex flex-col justify-between"},ke={key:0,class:"text-center py-8"},Ce={class:"text-lg font-semibold text-slate-700 mb-2"},Ee={class:"text-slate-500 text-sm"},Ae={key:1},De={key:0,class:"mb-3 relative"},Se=["onClick"],Te={key:0,class:"w-4 h-4 mr-1 bg-white/30 rounded-full animate-pulse"},He=["src"],Le={key:2,class:"w-4 h-4 bg-gradient-to-r from-cyan-400 to-blue-500 rounded-full flex items-center justify-center text-white font-bold text-[8px] mr-1"},Me={class:"flex justify-between items-center mb-3"},je={class:"flex items-center"},Pe={key:0,class:"w-5 h-5 mr-2 bg-white/30 rounded-full animate-pulse"},Ve=["src"],Ue={class:"text-md font-bold text-slate-800 drop-shadow-sm"},Ze={key:0,class:"text-xs text-red-500 mt-0.5"},$e={class:"flex items-center space-x-2"},qe=["disabled"],Ne={key:0,class:"ml-1 bg-cyan-100/80 text-cyan-800 text-xs px-2 py-0.5 rounded-full"},Re={key:1,class:"mb-3 p-2 bg-emerald-100/80 text-emerald-800 rounded-xl text-sm text-center border border-emerald-200"},Be={class:"mb-3"},Fe={class:"block text-xs font-medium text-slate-700 mb-1 drop-shadow-sm"},ze=["value"],Ie={class:"flex justify-center"},We=["src"],Xe={class:"mb-2"},Oe={class:"block text-xs font-medium text-slate-700 mb-1 drop-shadow-sm"},Qe={class:"flex items-center bg-white/50 border border-white/40 p-1 sm:p-2 rounded-lg backdrop-blur-sm shadow-lg"},Ge={class:"text-[10px] sm:text-[9px] md:text-xs lg:text-sm text-slate-800 flex-1 break-all"},Ke={key:0,class:"mt-1 text-xs text-red-500"},Je={class:"mb-2"},Ye={class:"block text-xs font-medium text-slate-700 mb-1 drop-shadow-sm"},et=["disabled","placeholder"],tt={key:0,class:"text-red-500 text-xs mt-1"},st={key:1,class:"mt-1 text-xs text-cyan-700 bg-cyan-50/80 p-2 rounded-lg border border-cyan-200"},lt={class:"mb-4"},ot={class:"block text-xs font-medium text-slate-700 mb-1 drop-shadow-sm"},at={key:0,class:"text-red-500 text-xs mt-1"},rt=["disabled"],nt={key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},it={class:"bg-gradient-to-br from-white/95 via-blue-50/90 to-indigo-50/95 backdrop-blur-sm p-6 rounded-2xl sm:rounded-3xl w-full max-w-md max-h-[80vh] overflow-y-auto shadow-2xl border border-white/40"},ut={class:"flex justify-between items-center mb-4"},dt={class:"flex items-center"},ct={class:"text-lg font-semibold text-slate-800 drop-shadow-sm"},vt={key:0,class:"ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},pt={key:1,class:"ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800"},mt={key:2,class:"ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},ht={key:3,class:"ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"},ft={class:"flex items-center space-x-2"},xt={key:0,class:"text-center py-4"},bt={class:"text-sm text-slate-500 mt-2"},yt={key:1,class:"text-red-500 text-sm mb-2 p-3 bg-red-50 rounded-xl border border-red-200"},gt={key:2,class:"text-slate-500 text-sm text-center py-4"},_t={key:3,class:"space-y-3"},wt={class:"flex justify-between"},kt={class:"text-slate-800 font-medium text-sm"},Ct={class:"text-slate-500 text-xs mt-1"},Et={key:0,class:"text-center pt-4"},At=["disabled"],Tt={__name:"Deposit",props:{cryptos:{type:Array,required:!0},cryptoDetails:{type:Object,default:()=>({})},vip:{type:[String,null],default:null},prefillAmount:{type:[Number,String,null],default:null}},setup(W){var J;const g=ue(),te=S(()=>g.props.translations||{}),n=t=>te.value[t]||t,b=W,d=u([...b.cryptos]),N=u({...b.cryptoDetails}),R=u(!1),X=u(null),_=u(!1),m=u(0),w=u(0),O=u(!1),Q=u(!1),H=u(null),L=S(()=>{var s;const t=(s=k.value)==null?void 0:s.currency;return t?N.value[t]:null}),k=S(()=>d.value[m.value]||null),G=S(()=>{var t;return((t=k.value)==null?void 0:t.currency)||""}),K=S(()=>{var t;return((t=k.value)==null?void 0:t.address)||""}),se=S(()=>{var t;return(t=k.value)!=null&&t.qr_code?`/storage/${k.value.qr_code}`:""});let M=null;const h=u("connecting"),j=async(t=!0,s=1,v=20)=>{var l;t&&(_.value=!0,V.value=null);try{const x=((l=document.querySelector('meta[name="csrf-token"]'))==null?void 0:l.getAttribute("content"))||g.props.csrf_token,A=await fetch(`/deposit/history?page=${s}&per_page=${v}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","Cache-Control":"no-cache",Pragma:"no-cache","X-CSRF-TOKEN":x,"X-Requested-With":"XMLHttpRequest"}});if(!A.ok)throw new Error(`HTTP error! status: ${A.status}`);const D=await A.json();s===1?c.value=D.deposits||D.data||[]:c.value=[...c.value,...D.deposits||D.data||[]],C.value=D.pagination||D.meta||{}}catch(x){console.error("History fetch error:",x),V.value="Failed to load deposit history.",s===1&&(c.value=[])}finally{_.value=!1}};de(()=>{var s,v;d.value.length>0&&(i.value.crypto_id=d.value[0].id),setTimeout(()=>Z(),100),window.Echo?(console.log("Setting up crypto updates listener"),window.Echo.channel("crypto-updates").listen(".crypto.updated",l=>{console.log("Received crypto update:",l),d.value=[...l.cryptos],d.value[m.value]||(m.value=0),d.value[m.value]&&(i.value.crypto_id=d.value[m.value].id),Z()}).error(l=>{console.error("Echo channel error:",l)})):console.log("Echo not available");const t=(v=(s=g.props.auth)==null?void 0:s.user)==null?void 0:v.id;t&&window.Echo?(h.value="connecting",window.Echo.private(`user.${t}`).listen(".App\\Events\\DepositStatusUpdated",l=>{if(h.value="connected",c.value.length>0){const x=c.value.find(A=>A.id===l.deposit.id);x&&(x.status=l.deposit.status,c.value=[...c.value])}}).listen(".App\\Events\\DepositCreated",l=>{h.value="connected",f.value&&l.deposit&&(c.value.unshift(l.deposit),c.value.length>50&&(c.value=c.value.slice(0,50)))}).error(l=>{h.value="disconnected",f.value&&$()}),setTimeout(()=>{h.value==="connecting"&&(h.value="polling",f.value&&$())},3e3)):(h.value="polling",f.value&&$())}),ce(()=>{var s,v;const t=(v=(s=g.props.auth)==null?void 0:s.user)==null?void 0:v.id;t&&window.Echo&&window.Echo.private(`user.${t}`).stopListening(".App\\Events\\DepositStatusUpdated").stopListening(".App\\Events\\DepositCreated"),window.Echo&&window.Echo.leaveChannel("crypto-updates"),q()});const P=u(!1),T=u(null),f=u(!1),c=u([]),C=u({}),V=u(null),U=u((J=g.props.flash)==null?void 0:J.success),E=u({}),i=u({amount:b.prefillAmount||"",slip:null,vip:b.vip||null,crypto_id:null}),le=t=>{m.value=t,d.value[t]&&(i.value.crypto_id=d.value[t].id)},oe=()=>{w.value=Math.max(0,w.value-100),Z()},ae=()=>{var s;const t=d.value.length*80-(((s=H.value)==null?void 0:s.offsetWidth)||300);w.value=Math.min(t,w.value+100),Z()},Z=()=>{if(!H.value)return;const t=H.value.offsetWidth,v=d.value.length*80-t;O.value=w.value>0,Q.value=w.value<v&&v>0};B(m,t=>{d.value[t]&&(i.value.crypto_id=d.value[t].id)}),B(()=>b.prefillAmount,t=>{t&&t!==i.value.amount&&(i.value.amount=t)}),B(()=>b.vip,t=>{t!==i.value.vip&&(i.value.vip=t)});const re=async()=>{const t=K.value;if(T.value=null,navigator.clipboard&&navigator.clipboard.writeText)try{await navigator.clipboard.writeText(t),P.value=!0,setTimeout(()=>P.value=!1,2e3);return}catch{T.value=n("Failed to copy address. Please copy manually.")}try{const s=document.createElement("textarea");s.value=t,document.body.appendChild(s),s.select(),document.execCommand("copy"),document.body.removeChild(s),P.value=!0,setTimeout(()=>P.value=!1,2e3)}catch{T.value=n("Failed to copy address. Please copy manually.")}},$=()=>{q(),h.value="polling",M=setInterval(()=>{f.value&&j(!1)},3e3)},q=()=>{M&&(clearInterval(M),M=null)},ne=()=>{if(C.value.current_page<C.value.last_page){const t=C.value.current_page+1;j(!0,t,C.value.per_page)}},ie=()=>{if(!i.value.crypto_id){alert(n("Please select a cryptocurrency"));return}const t=new FormData;t.append("amount",i.value.amount),t.append("slip",i.value.slip),t.append("crypto_id",i.value.crypto_id),t.append("_token",g.props.csrf_token),i.value.vip&&t.append("vip",i.value.vip),xe.post(route("deposit.store"),t,{preserveState:!0,preserveScroll:!0,onSuccess:()=>{var s;U.value="Deposit submitted successfully! Awaiting approval.",setTimeout(()=>U.value=null,3e3),i.value={amount:b.prefillAmount||"",slip:null,vip:b.vip||null,crypto_id:((s=d.value[m.value])==null?void 0:s.id)||null},E.value={},f.value&&j(!1)},onError:s=>{E.value=s}})};return(t,s)=>(a(),o(z,null,[F(Y(ve),{title:n("Deposit")},null,8,["title"]),F(be,null,{default:pe(()=>{var v;return[e("div",ge,[e("div",_e,[e("div",we,[d.value.length===0?(a(),o("div",ke,[s[4]||(s[4]=e("div",{class:"text-slate-600 mb-4"},[e("svg",{class:"w-16 h-16 mx-auto mb-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})])],-1)),e("h2",Ce,r(n("No Cryptocurrencies Available")),1),e("p",Ee,r(n("Please contact admin to add cryptocurrency options.")),1)])):(a(),o("div",Ae,[d.value.length>1?(a(),o("div",De,[e("div",{ref_key:"tabContainer",ref:H,class:"flex space-x-1 bg-white/20 p-1 rounded-lg overflow-hidden"},[e("div",{class:"flex space-x-1 transition-transform duration-300",style:me({transform:`translateX(-${w.value}px)`})},[(a(!0),o(z,null,ee(d.value,(l,x)=>(a(),o("button",{key:l.id,onClick:A=>le(x),class:I([{"bg-white/80 text-slate-800 shadow-lg":m.value===x,"text-slate-600 hover:text-slate-800 hover:bg-white/40":m.value!==x},"flex items-center px-2 py-1 rounded-md text-xs font-medium transition-all duration-200 whitespace-nowrap flex-shrink-0"])},[R.value&&m.value===x?(a(),o("div",Te)):N.value[l.currency]?(a(),o("img",{key:1,src:N.value[l.currency].image,alt:"Crypto Logo",class:"w-4 h-4 mr-1"},null,8,He)):(a(),o("div",Le,r(l.currency.substring(0,2)),1)),y(" "+r(l.currency),1)],10,Se))),128))],4)],512),O.value?(a(),o("button",{key:0,onClick:oe,class:"absolute left-0 top-1/2 -translate-y-1/2 bg-white/20 hover:bg-white/30 text-slate-700 w-5 h-5 flex items-center justify-center backdrop-blur-sm z-10 text-xs"}," ‹ ")):p("",!0),Q.value?(a(),o("button",{key:1,onClick:ae,class:"absolute right-0 top-1/2 -translate-y-1/2 bg-white/20 hover:bg-white/30 text-slate-700 w-5 h-5 flex items-center justify-center backdrop-blur-sm z-10 text-xs"}," › ")):p("",!0)])):p("",!0),e("div",Me,[e("div",je,[R.value?(a(),o("div",Pe)):L.value?(a(),o("img",{key:1,src:L.value.image,alt:"Crypto Logo",class:"w-5 h-5 mr-2"},null,8,Ve)):p("",!0),e("div",null,[e("h1",Ue,r(R.value?n("Loading..."):L.value?L.value.name:G.value||n("Deposit")),1),X.value?(a(),o("div",Ze,r(X.value),1)):p("",!0)])]),e("div",$e,[e("button",{onClick:s[0]||(s[0]=()=>{f.value?(f.value=!1,q()):(f.value=!0,j(),$())}),class:"flex items-center text-cyan-600 font-medium text-sm hover:text-cyan-700 transition-all duration-200 drop-shadow-sm",disabled:_.value},[F(Y(ye),{class:"w-4 h-4 mr-1"}),y(" "+r(_.value?n("Loading..."):n("History"))+" ",1),c.value.length>0?(a(),o("span",Ne,r(c.value.length),1)):p("",!0)],8,qe)])]),U.value?(a(),o("div",Re,r(U.value),1)):p("",!0),e("div",Be,[e("label",Fe,r(n("Network")),1),e("input",{disabled:"",type:"text",value:((v=k.value)==null?void 0:v.network)||"TBD",class:"mt-1 block w-full h-8 rounded-lg bg-white/30 border-0 text-slate-700 cursor-not-allowed px-3 backdrop-blur-sm shadow-lg text-sm"},null,8,ze)]),e("div",Ie,[e("img",{src:se.value||"https://via.placeholder.com/150?text=No+QR+Code",alt:"QR Code",class:"w-24 h-24 sm:w-32 sm:h-32"},null,8,We)]),e("div",Xe,[e("label",Oe,r(n("Address")),1),e("div",Qe,[e("span",Ge,r(K.value),1),e("button",{onClick:re,class:"ml-2 px-2 py-1 bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-600 hover:to-blue-700 text-white text-xs rounded-md transition-all duration-200 shadow-lg"},r(n("Copy")),1)]),T.value?(a(),o("div",Ke,r(T.value),1)):p("",!0)]),e("div",Je,[e("label",Ye,r(n("Enter amount in"))+" "+r(G.value),1),he(e("input",{"onUpdate:modelValue":s[1]||(s[1]=l=>i.value.amount=l),disabled:!!i.value.vip,type:"number",step:"any",placeholder:n("Enter amount"),class:I(["mt-1 block w-full h-8 rounded-lg border-0 focus:ring-2 focus:ring-cyan-400 text-slate-900 px-3 placeholder-slate-400 backdrop-blur-sm shadow-lg text-sm",i.value.vip?"bg-white/30":"bg-white/50"])},null,10,et),[[fe,i.value.amount]]),E.value.amount?(a(),o("div",tt,r(E.value.amount),1)):p("",!0),i.value.vip?(a(),o("div",st,[y(r(n("This deposit is for"))+" ",1),e("strong",null,r(i.value.vip),1),y(". "+r(n("Amount is fixed for this VIP purchase.")),1)])):p("",!0)]),e("div",lt,[e("label",ot,r(n("Upload Screenshot")),1),e("input",{type:"file",onChange:s[2]||(s[2]=l=>i.value.slip=l.target.files[0]),accept:"image/*",class:"mt-1 block w-full h-8 rounded-lg bg-white/50 border-0 focus:ring-2 focus:ring-cyan-400 text-slate-900 px-3 backdrop-blur-sm shadow-lg file:mr-2 file:py-1 file:px-2 file:rounded-md file:border-0 file:text-xs file:font-medium file:bg-cyan-50 file:text-cyan-700 hover:file:bg-cyan-100"},null,32),E.value.slip?(a(),o("div",at,r(E.value.slip),1)):p("",!0)]),e("button",{onClick:ie,disabled:!i.value.amount||!i.value.slip||!k.value,class:"w-full px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-medium rounded-lg transition-all duration-200 transform hover:scale-[1.02] shadow-md hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed text-sm"},r(n("Submit Deposit")),9,rt)]))])]),f.value?(a(),o("div",nt,[e("div",it,[e("div",ut,[e("div",dt,[e("h2",ct,r(n("Deposit History")),1),h.value==="connected"?(a(),o("span",vt,[...s[5]||(s[5]=[e("div",{class:"w-2 h-2 bg-green-400 rounded-full mr-1 animate-pulse"},null,-1),y(" Live ",-1)])])):h.value==="polling"?(a(),o("span",pt,[...s[6]||(s[6]=[e("div",{class:"w-2 h-2 bg-yellow-400 rounded-full mr-1 animate-pulse"},null,-1),y(" Polling ",-1)])])):h.value==="connecting"?(a(),o("span",mt,[...s[7]||(s[7]=[e("div",{class:"w-2 h-2 bg-blue-400 rounded-full mr-1 animate-pulse"},null,-1),y(" Connecting ",-1)])])):(a(),o("span",ht,[...s[8]||(s[8]=[e("div",{class:"w-2 h-2 bg-red-400 rounded-full mr-1"},null,-1),y(" Offline ",-1)])]))]),e("div",ft,[e("button",{onClick:s[3]||(s[3]=()=>{f.value=!1,q()}),class:"text-slate-400 hover:text-slate-600 transition-colors duration-200"},[...s[9]||(s[9]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),_.value?(a(),o("div",xt,[s[10]||(s[10]=e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-cyan-600 mx-auto"},null,-1)),e("p",bt,r(n("Loading history...")),1)])):V.value?(a(),o("div",yt,r(V.value),1)):c.value.length===0?(a(),o("div",gt,r(n("No deposit history available.")),1)):(a(),o("div",_t,[(a(!0),o(z,null,ee(c.value,l=>(a(),o("div",{key:l.id,class:"bg-gradient-to-r from-white/40 via-white/30 to-white/20 backdrop-blur-sm p-4 rounded-xl border border-white/30 shadow-lg"},[e("div",wt,[e("span",kt,r(l.amount)+" "+r(l.symbol?l.symbol.toUpperCase():"USDT"),1),e("span",{class:I({"px-3 py-1 rounded-full text-xs font-medium shadow-sm":!0,"bg-yellow-100/80 text-yellow-800 border border-yellow-200":l.status==="pending","bg-green-100/80 text-green-800 border border-green-200":l.status==="approved","bg-red-100/80 text-red-800 border border-red-200":l.status==="rejected"})},r(l.status.charAt(0).toUpperCase()+l.status.slice(1)),3)]),e("div",Ct,r(new Date(l.created_at).toLocaleString()),1)]))),128)),C.value.current_page<C.value.last_page?(a(),o("div",Et,[e("button",{onClick:ne,disabled:_.value,class:"px-4 py-2 bg-cyan-500 hover:bg-cyan-600 text-white text-sm rounded-lg transition-colors duration-200 disabled:opacity-50"},r(_.value?n("Loading..."):n("Load More")),9,At)])):p("",!0)]))])])):p("",!0)])]}),_:1})],64))}};export{Tt as default};
