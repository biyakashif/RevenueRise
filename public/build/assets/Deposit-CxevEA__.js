import{a as o,e,o as a,u as ie,c as E,r as u,q as ue,s as de,z as B,b as z,d as K,h as ce,w as ve,k as p,t as r,H as pe,F,j as Y,y as I,A as y,i as me,m as he,n as xe}from"./app-CdvAI5iq.js";import{_ as fe}from"./AuthenticatedLayout-DBI621vr.js";function be(q,A){return a(),o("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M7.502 6h7.128A3.375 3.375 0 0 1 18 9.375v9.375a3 3 0 0 0 3-3V6.108c0-1.505-1.125-2.811-2.664-2.94a48.972 48.972 0 0 0-.673-.05A3 3 0 0 0 15 1.5h-1.5a3 3 0 0 0-2.663 1.618c-.225.015-.45.032-.673.05C8.662 3.295 7.554 4.542 7.502 6ZM13.5 3A1.5 1.5 0 0 0 12 4.5h4.5A1.5 1.5 0 0 0 15 3h-1.5Z","clip-rule":"evenodd"}),e("path",{"fill-rule":"evenodd",d:"M3 9.375C3 8.339 3.84 7.5 4.875 7.5h9.75c1.036 0 1.875.84 1.875 1.875v11.25c0 1.035-.84 1.875-1.875 1.875h-9.75A1.875 1.875 0 0 1 3 20.625V9.375ZM6 12a.75.75 0 0 1 .75-.75h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75H6.75a.75.75 0 0 1-.75-.75V12Zm2.25 0a.75.75 0 0 1 .75-.75h3.75a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1-.75-.75ZM6 15a.75.75 0 0 1 .75-.75h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75H6.75a.75.75 0 0 1-.75-.75V15Zm2.25 0a.75.75 0 0 1 .75-.75h3.75a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1-.75-.75ZM6 18a.75.75 0 0 1 .75-.75h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75H6.75a.75.75 0 0 1-.75-.75V18Zm2.25 0a.75.75 0 0 1 .75-.75h3.75a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1-.75-.75Z","clip-rule":"evenodd"})])}const ye={class:"bg-gradient-to-br from-cyan-400/20 via-blue-500/15 to-indigo-600/20 backdrop-blur-sm p-4 sm:p-6 rounded-2xl sm:rounded-3xl shadow-2xl border border-cyan-300/30 h-full overflow-y-auto"},ge={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},_e={class:"bg-gradient-to-br from-cyan-400/20 via-blue-500/15 to-indigo-600/20 backdrop-blur-sm p-4 sm:p-6 rounded-2xl sm:rounded-3xl shadow-lg border border-cyan-300/30 w-full flex flex-col justify-between"},we={key:0,class:"text-center py-8"},ke={class:"text-lg font-semibold text-slate-700 mb-2"},Ce={class:"text-slate-500 text-sm"},Ee={key:1},Ae={key:0,class:"mb-3 relative"},De=["onClick"],Le={key:0,class:"w-4 h-4 mr-1 bg-white/30 rounded-full animate-pulse"},Me=["src"],Se={key:2,class:"w-4 h-4 bg-gradient-to-r from-cyan-400 to-blue-500 rounded-full flex items-center justify-center text-white font-bold text-[8px] mr-1"},He={class:"flex justify-between items-center mb-3"},je={class:"flex items-center"},Pe={key:0,class:"w-5 h-5 mr-2 bg-white/30 rounded-full animate-pulse"},Te=["src"],Ve={class:"text-md font-bold text-slate-800 drop-shadow-sm"},Ne={key:0,class:"text-xs text-red-500 mt-0.5"},Ue={class:"flex items-center space-x-2"},Ze=["disabled"],$e={key:0,class:"ml-1 bg-cyan-100/80 text-cyan-800 text-xs px-2 py-0.5 rounded-full"},Be={key:1,class:"mb-3 p-2 bg-emerald-100/80 text-emerald-800 rounded-xl text-sm text-center border border-emerald-200"},ze={class:"mb-3"},Fe={class:"block text-xs font-medium text-slate-700 mb-1 drop-shadow-sm"},Ie=["value"],qe={class:"flex justify-center"},Re=["src"],We={class:"mb-2"},Oe={class:"block text-xs font-medium text-slate-700 mb-1 drop-shadow-sm"},Qe={class:"flex items-center bg-white/50 border border-white/40 p-1 sm:p-2 rounded-lg backdrop-blur-sm shadow-lg"},Xe={class:"text-[10px] sm:text-[9px] md:text-xs lg:text-sm text-slate-800 flex-1 break-all"},Ge={key:0,class:"mt-1 text-xs text-red-500"},Je={class:"mb-2"},Ke={class:"block text-xs font-medium text-slate-700 mb-1 drop-shadow-sm"},Ye=["disabled","placeholder"],et={key:0,class:"text-red-500 text-xs mt-1"},tt={key:1,class:"mt-1 text-xs text-cyan-700 bg-cyan-50/80 p-2 rounded-lg border border-cyan-200"},st={class:"mb-4"},lt={class:"block text-xs font-medium text-slate-700 mb-1 drop-shadow-sm"},ot={key:0,class:"text-red-500 text-xs mt-1"},at=["disabled"],rt={key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},nt={class:"bg-gradient-to-br from-white/95 via-blue-50/90 to-indigo-50/95 backdrop-blur-sm p-6 rounded-2xl sm:rounded-3xl w-full max-w-md max-h-[80vh] overflow-y-auto shadow-2xl border border-white/40"},it={class:"flex justify-between items-center mb-4"},ut={class:"flex items-center"},dt={class:"text-lg font-semibold text-slate-800 drop-shadow-sm"},ct={key:0,class:"ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},vt={key:1,class:"ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800"},pt={key:2,class:"ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},mt={key:3,class:"ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"},ht={class:"flex items-center space-x-2"},xt={key:0,class:"text-center py-4"},ft={class:"text-sm text-slate-500 mt-2"},bt={key:1,class:"text-red-500 text-sm mb-2 p-3 bg-red-50 rounded-xl border border-red-200"},yt={key:2,class:"text-slate-500 text-sm text-center py-4"},gt={key:3,class:"space-y-3"},_t={class:"flex justify-between"},wt={class:"text-slate-800 font-medium text-sm"},kt={class:"text-slate-500 text-xs mt-1"},Ct={key:0,class:"text-center pt-4"},Et=["disabled"],Lt={__name:"Deposit",props:{cryptos:{type:Array,required:!0},cryptoDetails:{type:Object,default:()=>({})},vip:{type:[String,null],default:null},prefillAmount:{type:[Number,String,null],default:null}},setup(q){var G;const A=ie(),ee=E(()=>A.props.translations||{}),n=t=>ee.value[t]||t,b=q,d=u([...b.cryptos]),Z=u({...b.cryptoDetails}),$=u(!1),R=u(null),g=u(!1),m=u(0),_=u(0),W=u(!1),O=u(!1),L=u(null),M=E(()=>{var s;const t=(s=w.value)==null?void 0:s.currency;return t?Z.value[t]:null}),w=E(()=>d.value[m.value]||null),Q=E(()=>{var t;return((t=w.value)==null?void 0:t.currency)||""}),X=E(()=>{var t;return((t=w.value)==null?void 0:t.address)||""}),te=E(()=>{var t;return(t=w.value)!=null&&t.qr_code?`/storage/${w.value.qr_code}`:""});let S=null;const h=u("connecting"),H=async(t=!0,s=1,v=20)=>{t&&(g.value=!0,P.value=null);try{const l=await fetch(`/deposit/history?page=${s}&per_page=${v}`,{headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);const f=await l.json();s===1?c.value=f.deposits||[]:c.value=[...c.value,...f.deposits||[]],k.value=f.pagination||{}}catch{P.value="Failed to load deposit history.",c.value=[]}finally{g.value=!1}};ue(()=>{var s,v;d.value.length>0&&(i.value.crypto_id=d.value[0].id),setTimeout(()=>V(),100),window.Echo?(console.log("Setting up crypto updates listener"),window.Echo.channel("crypto-updates").listen(".crypto.updated",l=>{console.log("Received crypto update:",l),d.value=[...l.cryptos],d.value[m.value]||(m.value=0),d.value[m.value]&&(i.value.crypto_id=d.value[m.value].id),V()}).error(l=>{console.error("Echo channel error:",l)})):console.log("Echo not available");const t=(v=(s=A.props.auth)==null?void 0:s.user)==null?void 0:v.id;t&&window.Echo?(h.value="connecting",window.Echo.private(`user.${t}`).listen(".App\\Events\\DepositStatusUpdated",l=>{if(h.value="connected",c.value.length>0){const f=c.value.find(J=>J.id===l.deposit.id);f&&(f.status=l.deposit.status,c.value=[...c.value])}}).listen(".App\\Events\\DepositCreated",l=>{h.value="connected",x.value&&l.deposit&&(c.value.unshift(l.deposit),c.value.length>50&&(c.value=c.value.slice(0,50)))}).error(l=>{h.value="disconnected",x.value&&N()}),setTimeout(()=>{h.value==="connecting"&&(h.value="polling",x.value&&N())},3e3)):(h.value="polling",x.value&&N())}),de(()=>{var s,v;const t=(v=(s=A.props.auth)==null?void 0:s.user)==null?void 0:v.id;t&&window.Echo&&window.Echo.private(`user.${t}`).stopListening(".App\\Events\\DepositStatusUpdated").stopListening(".App\\Events\\DepositCreated"),window.Echo&&window.Echo.leaveChannel("crypto-updates"),U()});const j=u(!1),D=u(null),x=u(!1),c=u([]),k=u({}),P=u(null),T=u((G=A.props.flash)==null?void 0:G.success),C=u({}),i=u({amount:b.prefillAmount||"",slip:null,vip:b.vip||null,crypto_id:null}),se=t=>{m.value=t,d.value[t]&&(i.value.crypto_id=d.value[t].id)},le=()=>{_.value=Math.max(0,_.value-100),V()},oe=()=>{var s;const t=d.value.length*80-(((s=L.value)==null?void 0:s.offsetWidth)||300);_.value=Math.min(t,_.value+100),V()},V=()=>{if(!L.value)return;const t=L.value.offsetWidth,v=d.value.length*80-t;W.value=_.value>0,O.value=_.value<v&&v>0};B(m,t=>{d.value[t]&&(i.value.crypto_id=d.value[t].id)}),B(()=>b.prefillAmount,t=>{t&&t!==i.value.amount&&(i.value.amount=t)}),B(()=>b.vip,t=>{t!==i.value.vip&&(i.value.vip=t)});const ae=async()=>{const t=X.value;if(D.value=null,navigator.clipboard&&navigator.clipboard.writeText)try{await navigator.clipboard.writeText(t),j.value=!0,setTimeout(()=>j.value=!1,2e3);return}catch{D.value=n("Failed to copy address. Please copy manually.")}try{const s=document.createElement("textarea");s.value=t,document.body.appendChild(s),s.select(),document.execCommand("copy"),document.body.removeChild(s),j.value=!0,setTimeout(()=>j.value=!1,2e3)}catch{D.value=n("Failed to copy address. Please copy manually.")}},N=()=>{U(),h.value="polling",S=setInterval(()=>{x.value&&H(!1)},3e3)},U=()=>{S&&(clearInterval(S),S=null)},re=()=>{if(k.value.current_page<k.value.last_page){const t=k.value.current_page+1;H(!0,t,k.value.per_page)}},ne=()=>{if(!i.value.crypto_id){alert(n("Please select a cryptocurrency"));return}const t=new FormData;t.append("amount",i.value.amount),t.append("slip",i.value.slip),t.append("crypto_id",i.value.crypto_id),i.value.vip&&t.append("vip",i.value.vip),xe.post(route("deposit.store"),t,{preserveState:!0,preserveScroll:!0,onSuccess:()=>{var s;T.value="Deposit submitted successfully! Awaiting approval.",setTimeout(()=>T.value=null,3e3),i.value={amount:b.prefillAmount||"",slip:null,vip:b.vip||null,crypto_id:((s=d.value[m.value])==null?void 0:s.id)||null},C.value={},x.value&&H(!1)},onError:s=>{C.value=s}})};return(t,s)=>(a(),o(F,null,[z(K(ce),{title:n("Deposit")},null,8,["title"]),z(fe,null,{default:ve(()=>{var v;return[e("div",ye,[e("div",ge,[e("div",_e,[d.value.length===0?(a(),o("div",we,[s[4]||(s[4]=e("div",{class:"text-slate-600 mb-4"},[e("svg",{class:"w-16 h-16 mx-auto mb-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})])],-1)),e("h2",ke,r(n("No Cryptocurrencies Available")),1),e("p",Ce,r(n("Please contact admin to add cryptocurrency options.")),1)])):(a(),o("div",Ee,[d.value.length>1?(a(),o("div",Ae,[e("div",{ref_key:"tabContainer",ref:L,class:"flex space-x-1 bg-white/20 p-1 rounded-lg overflow-hidden"},[e("div",{class:"flex space-x-1 transition-transform duration-300",style:pe({transform:`translateX(-${_.value}px)`})},[(a(!0),o(F,null,Y(d.value,(l,f)=>(a(),o("button",{key:l.id,onClick:J=>se(f),class:I([{"bg-white/80 text-slate-800 shadow-lg":m.value===f,"text-slate-600 hover:text-slate-800 hover:bg-white/40":m.value!==f},"flex items-center px-2 py-1 rounded-md text-xs font-medium transition-all duration-200 whitespace-nowrap flex-shrink-0"])},[$.value&&m.value===f?(a(),o("div",Le)):Z.value[l.currency]?(a(),o("img",{key:1,src:Z.value[l.currency].image,alt:"Crypto Logo",class:"w-4 h-4 mr-1"},null,8,Me)):(a(),o("div",Se,r(l.currency.substring(0,2)),1)),y(" "+r(l.currency),1)],10,De))),128))],4)],512),W.value?(a(),o("button",{key:0,onClick:le,class:"absolute left-0 top-1/2 -translate-y-1/2 bg-white/20 hover:bg-white/30 text-slate-700 w-5 h-5 flex items-center justify-center backdrop-blur-sm z-10 text-xs"}," ‹ ")):p("",!0),O.value?(a(),o("button",{key:1,onClick:oe,class:"absolute right-0 top-1/2 -translate-y-1/2 bg-white/20 hover:bg-white/30 text-slate-700 w-5 h-5 flex items-center justify-center backdrop-blur-sm z-10 text-xs"}," › ")):p("",!0)])):p("",!0),e("div",He,[e("div",je,[$.value?(a(),o("div",Pe)):M.value?(a(),o("img",{key:1,src:M.value.image,alt:"Crypto Logo",class:"w-5 h-5 mr-2"},null,8,Te)):p("",!0),e("div",null,[e("h1",Ve,r($.value?n("Loading..."):M.value?M.value.name:Q.value||n("Deposit")),1),R.value?(a(),o("div",Ne,r(R.value),1)):p("",!0)])]),e("div",Ue,[e("button",{onClick:s[0]||(s[0]=()=>{x.value.value?(x.value=!1,U()):(H(),x.value=!0,N())}),class:"flex items-center text-cyan-600 font-medium text-sm hover:text-cyan-700 transition-all duration-200 drop-shadow-sm",disabled:g.value},[z(K(be),{class:"w-4 h-4 mr-1"}),y(" "+r(g.value?n("Loading..."):n("History"))+" ",1),c.value.length>0?(a(),o("span",$e,r(c.value.length),1)):p("",!0)],8,Ze)])]),T.value?(a(),o("div",Be,r(T.value),1)):p("",!0),e("div",ze,[e("label",Fe,r(n("Network")),1),e("input",{disabled:"",type:"text",value:((v=w.value)==null?void 0:v.network)||"TBD",class:"mt-1 block w-full h-8 rounded-lg bg-white/30 border-0 text-slate-700 cursor-not-allowed px-3 backdrop-blur-sm shadow-lg text-sm"},null,8,Ie)]),e("div",qe,[e("img",{src:te.value||"https://via.placeholder.com/150?text=No+QR+Code",alt:"QR Code",class:"w-24 h-24 sm:w-32 sm:h-32"},null,8,Re)]),e("div",We,[e("label",Oe,r(n("Address")),1),e("div",Qe,[e("span",Xe,r(X.value),1),e("button",{onClick:ae,class:"ml-2 px-2 py-1 bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-600 hover:to-blue-700 text-white text-xs rounded-md transition-all duration-200 shadow-lg"},r(n("Copy")),1)]),D.value?(a(),o("div",Ge,r(D.value),1)):p("",!0)]),e("div",Je,[e("label",Ke,r(n("Enter amount in"))+" "+r(Q.value),1),me(e("input",{"onUpdate:modelValue":s[1]||(s[1]=l=>i.value.amount=l),disabled:!!i.value.vip,type:"number",step:"any",placeholder:n("Enter amount"),class:I(["mt-1 block w-full h-8 rounded-lg border-0 focus:ring-2 focus:ring-cyan-400 text-slate-900 px-3 placeholder-slate-400 backdrop-blur-sm shadow-lg text-sm",i.value.vip?"bg-white/30":"bg-white/50"])},null,10,Ye),[[he,i.value.amount]]),C.value.amount?(a(),o("div",et,r(C.value.amount),1)):p("",!0),i.value.vip?(a(),o("div",tt,[y(r(n("This deposit is for"))+" ",1),e("strong",null,r(i.value.vip),1),y(". "+r(n("Amount is fixed for this VIP purchase.")),1)])):p("",!0)]),e("div",st,[e("label",lt,r(n("Upload Screenshot")),1),e("input",{type:"file",onChange:s[2]||(s[2]=l=>i.value.slip=l.target.files[0]),accept:"image/*",class:"mt-1 block w-full h-8 rounded-lg bg-white/50 border-0 focus:ring-2 focus:ring-cyan-400 text-slate-900 px-3 backdrop-blur-sm shadow-lg file:mr-2 file:py-1 file:px-2 file:rounded-md file:border-0 file:text-xs file:font-medium file:bg-cyan-50 file:text-cyan-700 hover:file:bg-cyan-100"},null,32),C.value.slip?(a(),o("div",ot,r(C.value.slip),1)):p("",!0)]),e("button",{onClick:ne,disabled:!i.value.amount||!i.value.slip||!w.value,class:"w-full px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-medium rounded-lg transition-all duration-200 transform hover:scale-[1.02] shadow-md hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed text-sm"},r(n("Submit Deposit")),9,at)]))])]),x.value?(a(),o("div",rt,[e("div",nt,[e("div",it,[e("div",ut,[e("h2",dt,r(n("Deposit History")),1),h.value==="connected"?(a(),o("span",ct,[...s[5]||(s[5]=[e("div",{class:"w-2 h-2 bg-green-400 rounded-full mr-1 animate-pulse"},null,-1),y(" Live ",-1)])])):h.value==="polling"?(a(),o("span",vt,[...s[6]||(s[6]=[e("div",{class:"w-2 h-2 bg-yellow-400 rounded-full mr-1 animate-pulse"},null,-1),y(" Polling ",-1)])])):h.value==="connecting"?(a(),o("span",pt,[...s[7]||(s[7]=[e("div",{class:"w-2 h-2 bg-blue-400 rounded-full mr-1 animate-pulse"},null,-1),y(" Connecting ",-1)])])):(a(),o("span",mt,[...s[8]||(s[8]=[e("div",{class:"w-2 h-2 bg-red-400 rounded-full mr-1"},null,-1),y(" Offline ",-1)])]))]),e("div",ht,[e("button",{onClick:s[3]||(s[3]=()=>{x.value=!1,U()}),class:"text-slate-400 hover:text-slate-600 transition-colors duration-200"},[...s[9]||(s[9]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),g.value?(a(),o("div",xt,[s[10]||(s[10]=e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-cyan-600 mx-auto"},null,-1)),e("p",ft,r(n("Loading history...")),1)])):P.value?(a(),o("div",bt,r(P.value),1)):c.value.length===0?(a(),o("div",yt,r(n("No deposit history available.")),1)):(a(),o("div",gt,[(a(!0),o(F,null,Y(c.value,l=>(a(),o("div",{key:l.id,class:"bg-gradient-to-r from-white/40 via-white/30 to-white/20 backdrop-blur-sm p-4 rounded-xl border border-white/30 shadow-lg"},[e("div",_t,[e("span",wt,r(l.amount)+" "+r(l.symbol?l.symbol.toUpperCase():"USDT"),1),e("span",{class:I({"px-3 py-1 rounded-full text-xs font-medium shadow-sm":!0,"bg-yellow-100/80 text-yellow-800 border border-yellow-200":l.status==="pending","bg-green-100/80 text-green-800 border border-green-200":l.status==="approved","bg-red-100/80 text-red-800 border border-red-200":l.status==="rejected"})},r(l.status.charAt(0).toUpperCase()+l.status.slice(1)),3)]),e("div",kt,r(new Date(l.created_at).toLocaleString()),1)]))),128)),k.value.current_page<k.value.last_page?(a(),o("div",Ct,[e("button",{onClick:re,disabled:g.value,class:"px-4 py-2 bg-cyan-500 hover:bg-cyan-600 text-white text-sm rounded-lg transition-colors duration-200 disabled:opacity-50"},r(g.value?n("Loading..."):n("Load More")),9,Et)])):p("",!0)]))])])):p("",!0)])]}),_:1})],64))}};export{Lt as default};
