import{r as n,q as F,s as M,a as l,b as C,d as N,h as D,w as $,e,k as b,i as S,m as T,o as i,F as f,j,A as g,t as r,y as X,g as q,H as O,n as I}from"./app-CdvAI5iq.js";import{_ as V}from"./AdminLayout-DZFzOaKL.js";const P={class:"bg-gradient-to-br from-cyan-400/20 via-blue-500/15 to-indigo-600/20 backdrop-blur-xl p-4 rounded-2xl shadow-2xl border border-cyan-300/30 h-full overflow-y-auto"},B={class:"flex items-center justify-between mb-4"},H={class:"w-1/3"},z={class:"flex justify-between items-start"},K={class:"font-semibold text-slate-800 text-sm"},J={class:"text-xs text-slate-600"},Q={class:"text-xs text-slate-600 mt-1"},Y={class:"text-slate-800"},G=["onClick"],Z={class:"mt-2 space-y-2"},tt={class:"flex justify-between"},et={class:"flex items-center gap-2 mb-1"},ot={class:"text-sm text-slate-800 font-semibold"},st={key:0,class:"px-2 py-0.5 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-full text-xs font-medium shadow-sm"},at={class:"text-xs text-slate-600 mb-1"},rt={class:"text-xs text-slate-500"},lt={class:"flex flex-col items-end space-y-2"},it={class:"flex space-x-2"},nt=["onClick"],dt=["onClick"],ct=["onClick"],ut={class:"mb-4"},mt={key:0,class:"text-sm text-red-600 mb-4 bg-red-100/80 p-2 rounded-lg"},pt={class:"flex justify-end space-x-2"},vt={__name:"Withdrawals",setup(ht){const y=n([]);n(1),n(1);const d=n("");let _=null;const v=typeof document<"u"&&document.querySelector('meta[name="csrf-token"]')?document.querySelector('meta[name="csrf-token"]').getAttribute("content"):"",m=async(s="")=>{try{const t=s?`/admin/withdrawals?search=${encodeURIComponent(s)}`:"/admin/withdrawals",a=await fetch(t,{headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`HTTP ${a.status}`);const o=await a.json();y.value=(o.data||[]).map(c=>({...c,withdraw_limit:u(c.withdraw_limit)}))}catch{}};F(()=>{m(d.value),_=setInterval(()=>m(d.value),4e3)}),M(()=>{clearInterval(_)});const U=()=>{m(d.value)},L=async s=>{try{if(!(await fetch(route("admin.withdrawals.approve",s),{method:"POST",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":v}})).ok)throw new Error("Approve failed");await m(d.value)}catch{}},R=async s=>{try{if(!(await fetch(route("admin.withdrawals.reject",s),{method:"POST",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":v}})).ok)throw new Error("Reject failed");await m(d.value)}catch{}},W=s=>{I.visit(route("admin.withdrawals.edit",s))},h=n(!1),k=n(null),x=n(""),p=n(""),w=n({top:0,left:0}),A=(s,t,a)=>{k.value=s,x.value=t;const o=a.target.getBoundingClientRect();w.value={top:o.bottom+window.scrollY+10,left:Math.max(10,o.left+window.scrollX-200)},h.value=!0,p.value=""},u=s=>{if(s==null||s==="")return"0.00";const t=Number(s);return isFinite(t)?t.toFixed(2):"0.00"},E=async()=>{p.value="";try{const s=await fetch(route("admin.users.withdraw-limit.update",k.value),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":v},body:JSON.stringify({withdraw_limit:u(x.value)})}),t=await s.json();if(!s.ok)throw new Error(t.message||"Failed to update withdraw limit");h.value=!1,await m(d.value)}catch(s){p.value=s.message||"Failed to update withdraw limit"}};return(s,t)=>(i(),l(f,null,[C(N(D),{title:"Withdrawals"}),C(V,null,{default:$(()=>[e("div",P,[e("div",B,[t[6]||(t[6]=e("h1",{class:"text-lg font-bold text-slate-800 drop-shadow-sm"},"Withdrawals",-1)),e("div",H,[S(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>d.value=a),onInput:U,type:"text",placeholder:"Search name, mobile or code...",class:"w-full h-10 rounded-xl bg-white/50 border-0 focus:ring-2 focus:ring-cyan-400 text-slate-900 px-4 placeholder-slate-400 backdrop-blur-sm shadow-lg"},null,544),[[T,d.value]])])]),(i(!0),l(f,null,j(y.value,a=>(i(),l("div",{key:a.id,class:"mb-4 bg-white/20 backdrop-blur-sm p-4 rounded-xl shadow-lg border border-white/30"},[e("div",z,[e("div",null,[e("h3",K,[g(r(a.name)+" ",1),e("span",J,"â€” "+r(a.mobile_number)+" / "+r(a.invitation_code),1)]),e("div",Q,[t[7]||(t[7]=g(" Withdraw Limit: ",-1)),e("strong",Y,r(u(a.withdraw_limit)),1),t[8]||(t[8]=g(" USDT ",-1)),e("button",{onClick:o=>A(a.id,u(a.withdraw_limit),o),class:"ml-2 text-xs bg-white/20 backdrop-blur-sm px-2 py-1 rounded-lg hover:bg-white/30 transition-colors text-slate-700 border border-white/30"}," Change Limit ",8,G)])])]),e("div",Z,[(i(!0),l(f,null,j(a.withdraws,o=>(i(),l("div",{key:o.id,class:"bg-white/10 backdrop-blur-sm p-3 rounded-lg border border-white/20"},[e("div",tt,[e("div",null,[e("div",et,[e("span",ot,r(u(o.amount_withdraw))+" USDT",1),o.crypto_symbol&&o.crypto_symbol!=="USDT"?(i(),l("span",st,r(o.crypto_amount?o.crypto_symbol==="USDT"?u(o.crypto_amount):Number(o.crypto_amount).toFixed(6):u(o.amount_withdraw))+" "+r(o.crypto_symbol),1)):b("",!0)]),e("div",at,"To: "+r(o.crypto_wallet),1),e("div",rt,r(new Date(o.created_at).toLocaleString()),1)]),e("div",lt,[e("div",null,[e("span",{class:X({"px-2 py-1 rounded text-xs":!0,"bg-yellow-100 text-yellow-800":o.status==="under review","bg-green-100 text-green-800":o.status==="approved","bg-red-100 text-red-800":o.status==="rejected"})},r(o.status.split(" ").map(c=>c.charAt(0).toUpperCase()+c.slice(1)).join(" ")),3)]),e("div",it,[o.status==="under review"?(i(),l("button",{key:0,onClick:c=>L(o.id),class:"bg-gradient-to-r from-green-500 to-green-600 text-white px-3 py-1 rounded text-xs hover:from-green-600 hover:to-green-700 transform hover:scale-105 transition-all duration-200"},"Approve",8,nt)):b("",!0),o.status==="under review"?(i(),l("button",{key:1,onClick:c=>R(o.id),class:"bg-gradient-to-r from-red-500 to-red-600 text-white px-3 py-1 rounded text-xs hover:from-red-600 hover:to-red-700 transform hover:scale-105 transition-all duration-200"},"Reject",8,dt)):b("",!0),e("button",{onClick:c=>W(o.id),class:"bg-gradient-to-r from-blue-500 to-blue-600 text-white px-3 py-1 rounded text-xs hover:from-blue-600 hover:to-blue-700 transform hover:scale-105 transition-all duration-200"},"Edit",8,ct)])])])]))),128))])]))),128))]),h.value?(i(),l("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-40 z-50",onClick:t[5]||(t[5]=a=>h.value=!1)},[e("div",{class:"absolute bg-gradient-to-br from-cyan-400/20 via-blue-500/15 to-indigo-600/20 backdrop-blur-xl rounded-lg p-6 w-full max-w-md border border-white/20",style:O({top:w.value.top+"px",left:w.value.left+"px"}),onClick:t[4]||(t[4]=q(()=>{},["stop"]))},[t[10]||(t[10]=e("h3",{class:"text-lg font-semibold mb-4 text-slate-800"},"Update Withdraw Limit",-1)),e("div",ut,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"Minimum Withdraw Amount (USDT)",-1)),S(e("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>x.value=a),type:"number",step:"0.01",class:"w-full h-10 rounded-lg bg-white/50 border-0 focus:ring-2 focus:ring-cyan-400 text-slate-900 px-3 placeholder-slate-400 backdrop-blur-sm shadow-lg",min:"0.01"},null,512),[[T,x.value]])]),p.value?(i(),l("div",mt,r(p.value),1)):b("",!0),e("div",pt,[e("button",{onClick:t[2]||(t[2]=a=>{h.value=!1,p.value=""}),class:"px-4 py-2 bg-white/20 backdrop-blur-sm rounded-lg text-sm hover:bg-white/30 text-slate-700 border border-white/30"}," Cancel "),e("button",{onClick:t[3]||(t[3]=a=>E()),class:"px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded text-sm hover:from-blue-600 hover:to-blue-700 transform hover:scale-105 transition-all duration-200"}," Update ")])],4)])):b("",!0)]),_:1})],64))}};export{vt as default};
